<script>
function renderGraficos(f){

 // ðŸ”¹ ordenar cronologicamente
 const ordenado = [...f].sort((a,b)=>{
  const da = new Date(a.dia.split("/").reverse().join("-"));
  const db = new Date(b.dia.split("/").reverse().join("-"));
  return da - db;
 });

 let acc = 0;
 let labels = [];
 let saldo = [];

 ordenado.forEach(d=>{
  acc += d.pontos;
  labels.push(d.dia);
  saldo.push(acc);
 });

 if(chartLinha) chartLinha.destroy();
 if(chartBar) chartBar.destroy();

 chartLinha = new Chart(chartLinhaEl,{
  type:"line",
  data:{
   labels,
   datasets:[{
    data:saldo,
    borderColor:"#22c55e",
    backgroundColor:"rgba(34,197,94,.18)",
    tension:0.35,
    fill:true,
    pointRadius:4,
    pointHoverRadius:6
   }]
  },
  options:{
   responsive:true,
   maintainAspectRatio:false,
   plugins:{legend:{display:false}},
   scales:{
    y:{
     grid:{color:"rgba(255,255,255,.06)"},
     ticks:{color:"#9ca3af"}
    },
    x:{
     grid:{display:false},
     ticks:{color:"#9ca3af"}
    }
   }
  }
 });

 chartBar = new Chart(chartBarEl,{
  type:"bar",
  data:{
   labels:["Gain","Stop","0x0"],
   datasets:[{
    data:[
     f.reduce((a,b)=>a+b.gain,0),
     f.reduce((a,b)=>a+b.stop,0),
     f.reduce((a,b)=>a+b.zero,0)
    ],
    backgroundColor:["#22c55e","#ef4444","#facc15"],
    borderRadius:12
   }]
  },
  options:{
   responsive:true,
   maintainAspectRatio:false,
   plugins:{legend:{display:false}}
  }
 });
}
</script>
