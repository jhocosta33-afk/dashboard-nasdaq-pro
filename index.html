<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Dashboard NASDAQ PRO - Layout Sidebar</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
:root {
 --sidebar-bg: #0f1629;
 --main-bg: #0a0e27;
 --card-bg: #1a1f3a;
 --border: rgba(255,255,255,0.1);
 --text: #e5e7eb;
 --muted: #9ca3af;
 --green: #22c55e;
 --red: #ef4444;
 --yellow: #facc15;
 --blue: #3b82f6;
 --purple: #8b5cf6;
 --orange: #f59e0b;
}

* {
 margin: 0;
 padding: 0;
 box-sizing: border-box;
 font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
}

body {
 background: var(--main-bg);
 color: var(--text);
 display: flex;
 min-height: 100vh;
 overflow: hidden;
}

/* SIDEBAR */
.sidebar {
 width: 260px;
 background: var(--sidebar-bg);
 padding: 25px 18px;
 border-right: 1px solid var(--border);
 overflow-y: auto;
 display: flex;
 flex-direction: column;
 flex-shrink: 0;
}

.logo {
 display: flex;
 align-items: center;
 justify-content: center;
 margin-bottom: 30px;
}

.logo img {
 max-height: 80px;
 width: auto;
 max-width: 100%;
}

.filters {
 margin-bottom: 20px;
}

.filter-group {
 margin-bottom: 16px;
}

.filter-group label {
 display: block;
 font-size: 10px;
 text-transform: uppercase;
 letter-spacing: 1px;
 color: var(--muted);
 margin-bottom: 6px;
 font-weight: 600;
}

.filter-group select {
 width: 100%;
 background: var(--card-bg);
 color: var(--text);
 border: 1px solid var(--border);
 padding: 10px;
 border-radius: 8px;
 font-size: 13px;
 cursor: pointer;
 transition: all 0.2s;
}

.filter-group select:hover {
 border-color: var(--blue);
}

.filter-group select:focus {
 outline: none;
 border-color: var(--blue);
 box-shadow: 0 0 0 3px rgba(59,130,246,0.1);
}

.filter-group select:disabled {
 opacity: 0.5;
 cursor: not-allowed;
}

.mode-toggle {
 width: 100%;
 background: linear-gradient(135deg, #3b82f6, #2563eb);
 color: white;
 border: none;
 padding: 12px;
 border-radius: 10px;
 font-weight: 700;
 font-size: 13px;
 cursor: pointer;
 transition: all 0.2s;
 display: flex;
 align-items: center;
 justify-content: center;
 gap: 8px;
 text-transform: uppercase;
 letter-spacing: 1px;
 margin-top: 20px;
}

.mode-toggle:hover {
 transform: translateY(-2px);
 box-shadow: 0 8px 20px rgba(59,130,246,0.4);
}

.mode-toggle.pro {
 background: linear-gradient(135deg, #667eea, #764ba2);
}

/* MAIN CONTENT */
.main-content {
 flex: 1;
 padding: 25px 30px;
 overflow-y: auto;
 overflow-x: hidden;
 display: flex;
 justify-content: center;
}

.main-wrapper {
 width: 100%;
 max-width: 1400px;
}

.header-main {
 margin-bottom: 30px;
}

.header-main h1 {
 font-size: 26px;
 font-weight: 800;
 margin-bottom: 5px;
}

.header-main p {
 color: var(--muted);
 font-size: 13px;
}

/* KPIs HORIZONTAL */
.kpis {
 display: grid;
 grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
 gap: 12px;
 margin-bottom: 20px;
}

.kpi {
 background: var(--card-bg);
 padding: 14px 16px;
 border-radius: 10px;
 border: 1px solid var(--border);
 position: relative;
 overflow: hidden;
 transition: all 0.2s;
 min-height: 80px;
}

.kpi::before {
 content: '';
 position: absolute;
 top: 0;
 left: 0;
 width: 4px;
 height: 100%;
}

.kpi:hover {
 transform: translateY(-2px);
 box-shadow: 0 8px 20px rgba(0,0,0,0.3);
}

.kpi-dias::before { background: var(--blue); }
.kpi-trades::before { background: var(--purple); }
.kpi-pontos::before { background: var(--green); }
.kpi-acc::before { background: var(--orange); }
.kpi-gains::before { background: var(--green); }
.kpi-stops::before { background: var(--red); }
.kpi-zero::before { background: var(--yellow); }

.kpi span {
 display: block;
 font-size: 10px;
 text-transform: uppercase;
 letter-spacing: 1.2px;
 color: var(--muted);
 margin-bottom: 6px;
 font-weight: 600;
}

.kpi strong {
 display: block;
 font-size: 26px;
 font-weight: 700;
}

.kpi input {
 background: var(--main-bg);
 color: var(--text);
 border: 1px solid var(--border);
 border-radius: 8px;
 padding: 6px;
 font-size: 20px;
 font-weight: 800;
 width: 100%;
 margin-top: 4px;
 text-align: center;
}

/* CHARTS */
.charts {
 display: grid;
 grid-template-columns: 2fr 1fr;
 gap: 16px;
 margin-bottom: 20px;
}

.chart-card {
 background: var(--card-bg);
 padding: 18px;
 border-radius: 12px;
 border: 1px solid var(--border);
 display: flex;
 flex-direction: column;
 height: 240px;
}

.chart-card h3 {
 font-size: 13px;
 margin-bottom: 10px;
 font-weight: 600;
 display: flex;
 align-items: center;
 gap: 6px;
}

.chart-wrap {
 flex: 1;
 position: relative;
 min-height: 180px;
 max-height: 200px;
}

canvas {
 width: 100% !important;
 height: 100% !important;
}

/* CALENDAR */
.calendar-wrapper {
 margin-bottom: 20px;
 background: var(--card-bg);
 border: 1px solid var(--border);
 border-radius: 12px;
 padding: 18px;
}

.calendar-wrapper strong {
 display: block;
 margin-bottom: 12px;
 font-size: 14px;
 font-weight: 600;
}

.calendar-header {
 display: grid;
 grid-template-columns: repeat(7, 1fr);
 margin-bottom: 8px;
 text-align: center;
 color: var(--muted);
 font-size: 11px;
 font-weight: 600;
}

.calendar-grid {
 display: grid;
 grid-template-columns: repeat(7, 1fr);
 gap: 8px;
}

.day {
 position: relative;
 background: linear-gradient(180deg, #1a2332, var(--card-bg));
 border: 1px solid var(--border);
 border-radius: 8px;
 min-height: 75px;
 padding: 6px;
 padding-bottom: 28px;
 display: flex;
 flex-direction: column;
 transition: all 0.2s;
}

.day.positive {
 background: linear-gradient(180deg, #053a32, var(--card-bg));
}

.day.negative {
 background: linear-gradient(180deg, #3a0505, var(--card-bg));
}

.day:hover {
 transform: translateY(-2px);
 box-shadow: 0 4px 12px rgba(0,0,0,0.3);
}

.day-number {
 font-size: 10px;
 color: var(--muted);
}

.day-points {
 flex: 1;
 display: flex;
 align-items: center;
 justify-content: center;
 font-size: 22px;
 font-weight: 800;
}

.day-info {
 font-size: 9px;
 color: var(--muted);
 text-align: center;
 line-height: 1.2;
}

.day-badge {
 position: absolute;
 bottom: 4px;
 left: 50%;
 transform: translateX(-50%);
 background: rgba(0,0,0,0.8);
 border: 1px solid var(--border);
 border-radius: 6px;
 padding: 3px 6px;
 font-size: 8px;
 white-space: nowrap;
 opacity: 0;
 transition: opacity 0.2s ease;
}

.day:hover .day-badge {
 opacity: 1;
}

.empty {
 background: transparent;
 border: none;
}

/* TABLE */
.table-card {
 background: var(--card-bg);
 border: 1px solid var(--border);
 border-radius: 12px;
 padding: 18px;
 margin-bottom: 20px;
}

.table-card strong {
 display: block;
 margin-bottom: 12px;
 font-size: 14px;
 font-weight: 600;
}

.table-wrap {
 overflow-x: auto;
}

table {
 width: 100%;
 min-width: 900px;
 border-collapse: collapse;
}

thead {
 background: rgba(59,130,246,0.1);
}

th {
 color: var(--blue);
 font-weight: 700;
 font-size: 13px;
 padding: 12px 8px;
 text-align: center;
}

td {
 padding: 10px 8px;
 border-bottom: 1px solid var(--border);
 text-align: center;
 font-size: 13px;
}

thead th:first-child,
tbody td:first-child {
 text-align: left;
 padding-left: 16px;
}

tr.total {
 background: rgba(34,197,94,0.1);
 font-weight: 700;
}

/* MODO B√ÅSICO */
body.basic-mode .pro-only {
 display: none !important;
}

/* LOADING */
.loading-overlay {
 position: fixed;
 top: 0;
 left: 0;
 right: 0;
 bottom: 0;
 background: rgba(10,14,39,0.95);
 display: flex;
 align-items: center;
 justify-content: center;
 z-index: 9999;
 opacity: 1;
 transition: opacity 0.3s;
}

.loading-overlay.hidden {
 opacity: 0;
 pointer-events: none;
}

.spinner {
 width: 60px;
 height: 60px;
 border: 4px solid var(--border);
 border-top-color: var(--blue);
 border-radius: 50%;
 animation: spin 0.8s linear infinite;
}

@keyframes spin {
 to { transform: rotate(360deg); }
}

/* RESPONSIVE */
@media (max-width: 1024px) {
 body {
  flex-direction: column;
 }
 
 .sidebar {
  width: 100%;
  height: auto;
  border-right: none;
  border-bottom: 1px solid var(--border);
  overflow-y: visible;
 }
 
 .main-content {
  height: calc(100vh - 250px);
 }
 
 .charts {
  grid-template-columns: 1fr;
 }
}

@media (max-width: 768px) {
 .kpis {
  grid-template-columns: repeat(2, 1fr);
 }
 
 .calendar-grid {
  gap: 5px;
 }
 
 .day {
  min-height: 65px;
  padding: 4px;
  padding-bottom: 22px;
 }
 
 .day-points {
  font-size: 18px;
 }
 
 .day-info {
  font-size: 9px;
 }
}

@media (max-width: 480px) {
 .kpis {
  grid-template-columns: 1fr;
 }
}
</style>
</head>
<body>

<div class="loading-overlay" id="loading">
 <div class="spinner"></div>
</div>

<!-- SIDEBAR -->
<div class="sidebar">
 <div class="logo">
  <img src="logo.png" alt="Mentoria NasdaqPro" style="height: 80px; width: auto;" onerror="this.style.display='none'">
 </div>
 
 <div class="filters">
  <div class="filter-group">
   <label>Ano</label>
   <select id="filtroAno"></select>
  </div>
  <div class="filter-group">
   <label>M√™s</label>
   <select id="filtroMes"></select>
  </div>
  <div class="filter-group">
   <label>Semana</label>
   <select id="filtroSemana"></select>
  </div>
 </div>
 
 <button class="mode-toggle" id="toggleMode">
  <span id="modeIcon">üìä</span>
  <span id="modeText">B√ÅSICO</span>
 </button>
</div>

<!-- MAIN CONTENT -->
<div class="main-content">
 <div class="main-wrapper">
  <div class="header-main">
   <h1>Dashboard</h1>
   <p>Vis√£o geral das suas opera√ß√µes</p>
  </div>
  
  <div class="kpis">
  <div class="kpi kpi-dias">
   <span>Dias Operados</span>
   <strong id="kDias">0</strong>
  </div>
  <div class="kpi kpi-trades">
   <span>Trades</span>
   <strong id="kTrades">0</strong>
  </div>
  <div class="kpi kpi-pontos">
   <span>Pontos</span>
   <strong id="kPontos">0</strong>
  </div>
  <div class="kpi kpi-acc">
   <span>Assertividade</span>
   <strong id="kAcc">0%</strong>
  </div>
  <div class="kpi kpi-gains pro-only">
   <span>Gains</span>
   <strong id="kGains" style="color:var(--green)">0</strong>
  </div>
  <div class="kpi kpi-stops pro-only">
   <span>Stops</span>
   <strong id="kStops" style="color:var(--red)">0</strong>
  </div>
  <div class="kpi kpi-zero pro-only">
   <span>0x0</span>
   <strong id="kZero" style="color:var(--yellow)">0</strong>
  </div>
  <div class="kpi pro-only">
   <span>Contratos</span>
   <input type="number" id="contratos" value="0" min="0">
  </div>
  <div class="kpi pro-only">
   <span>Total em D√≥lar</span>
   <strong id="kDolar" style="color:var(--green)">$0.00</strong>
  </div>
 </div>
 
 <div class="charts pro-only">
  <div class="chart-card">
   <h3>üìà Evolu√ß√£o Acumulada</h3>
   <div class="chart-wrap">
    <canvas id="chartAcumulado"></canvas>
   </div>
  </div>
  <div class="chart-card">
   <h3>üìä Distribui√ß√£o</h3>
   <div class="chart-wrap">
    <canvas id="chartBar"></canvas>
   </div>
  </div>
 </div>
 
 <div class="calendar-wrapper pro-only">
  <strong>üìÖ Calend√°rio Operacional</strong>
  <div class="calendar-header">
   <div>Dom</div><div>Seg</div><div>Ter</div>
   <div>Qua</div><div>Qui</div><div>Sex</div><div>S√°b</div>
  </div>
  <div class="calendar-grid" id="calendar"></div>
 </div>
 
 <div class="table-card">
  <strong>üìã Tabela Operacional</strong>
  <div class="table-wrap">
   <table>
    <thead>
     <tr>
      <th>Dia</th><th>Pontos</th><th>Trades</th>
      <th>Gain</th><th>Stop</th><th>0x0</th>
      <th>Ativo</th><th>Semana</th>
     </tr>
    </thead>
    <tbody id="tbody"></tbody>
   </table>
  </div>
 </div>
 </div>
</div>

<script>
const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTbyybCny81vfVXQHmtlkKEOHHJ6xJ_pKSG_4ndkK0tH-YocrFeWY7qL41TS1IfvRQjLSbLIILV56OV/pub?output=csv";
const nomesMeses = {"01":"Janeiro","02":"Fevereiro","03":"Mar√ßo","04":"Abril","05":"Maio","06":"Junho","07":"Julho","08":"Agosto","09":"Setembro","10":"Outubro","11":"Novembro","12":"Dezembro"};

const Dashboard = {
 dados: [],
 primeiraCarga: true,
 chartAcumulado: null,
 chartBar: null,
 
 async init() {
  this.inicializarToggleMode();
  await this.carregarDados();
 },
 
 async carregarDados() {
  try {
   const response = await fetch(CSV_URL);
   if (!response.ok) throw new Error('Erro ao carregar');
   const texto = await response.text();
   this.processarCSV(texto);
   document.getElementById('loading').classList.add('hidden');
  } catch (erro) {
   console.error('Erro:', erro);
   alert('Erro ao carregar dados. Tente novamente.');
  }
 },
 
 processarCSV(texto) {
  const linhas = texto.trim().split(/\r?\n/);
  linhas.shift();
  
  this.dados = linhas.map(linha => {
   const cols = linha.split(",");
   const [d, m, a] = cols[0].split("/");
   return {
    dia: cols[0],
    data: new Date(a, m-1, d),
    semana: cols[1],
    ativo: cols[2],
    ano: a,
    mes: m,
    pontos: +cols[3] || 0,
    trades: +cols[4] || 0,
    gain: +cols[5] || 0,
    stop: +cols[6] || 0,
    zero: +cols[7] || 0
   };
  }).filter(Boolean);
  
  this.inicializarFiltros();
  this.inicializarCalculadora();
 },
 
 inicializarFiltros() {
  const anos = [...new Set(this.dados.map(d => d.ano))].sort();
  filtroAno.innerHTML = anos.map(a => `<option value="${a}">${a}</option>`).join("");
  
  const anoAtual = new Date().getFullYear().toString();
  filtroAno.value = anos.includes(anoAtual) ? anoAtual : anos[anos.length-1];
  
  filtroAno.onchange = () => {
   this.primeiraCarga = false;
   this.inicializarMeses();
   this.atualizar();
  };
  
  this.inicializarMeses();
 },
 
 inicializarMeses() {
  const meses = [...new Set(this.dados.filter(d => d.ano === filtroAno.value).map(d => d.mes))];
  filtroMes.innerHTML = '<option value="ALL">Todos os meses</option>' +
   meses.map(m => `<option value="${m}">${nomesMeses[m]}</option>`).join("");
  
  const mesAtual = (new Date().getMonth()+1).toString().padStart(2,"0");
  filtroMes.value = this.primeiraCarga && meses.includes(mesAtual) ? mesAtual : "ALL";
  
  filtroMes.onchange = () => {
   this.primeiraCarga = false;
   
   // Bloqueia/Desbloqueia select de semanas
   if (filtroMes.value === "ALL") {
    filtroSemana.disabled = true;
    filtroSemana.value = "ALL";
   } else {
    filtroSemana.disabled = false;
   }
   
   this.inicializarSemanas();
   this.atualizar();
  };
  
  // Inicializa estado do select de semanas
  if (filtroMes.value === "ALL") {
   filtroSemana.disabled = true;
  }
  
  this.inicializarSemanas();
 },
 
 inicializarSemanas() {
  const semanas = [...new Set(
   this.dados.filter(d =>
    d.ano === filtroAno.value &&
    (filtroMes.value === "ALL" || d.mes === filtroMes.value)
   ).map(d => d.semana)
  )].sort((a,b) => a-b);
  
  filtroSemana.innerHTML = '<option value="ALL">Todas as semanas</option>' +
   semanas.map(s => `<option value="${s}">${s}</option>`).join("");
  
  if (this.primeiraCarga) {
   const hoje = new Date();
   const atual = this.dados.find(d => d.data.toDateString() === hoje.toDateString());
   filtroSemana.value = atual?.semana || "ALL";
  } else {
   filtroSemana.value = "ALL";
  }
  
  filtroSemana.onchange = () => {
   this.primeiraCarga = false;
   this.atualizar();
  };
  
  this.atualizar();
 },
 
 inicializarCalculadora() {
  const input = document.getElementById('contratos');
  if (input) {
   input.addEventListener('input', () => this.atualizar());
  }
 },
 
 inicializarToggleMode() {
  const toggleBtn = document.getElementById('toggleMode');
  const modeIcon = document.getElementById('modeIcon');
  const modeText = document.getElementById('modeText');
  let isProMode = true; // COME√áA EM PRO AGORA
  
  // Define modo PRO como padr√£o
  document.body.classList.remove('basic-mode');
  toggleBtn.classList.add('pro');
  modeIcon.textContent = '‚ö°';
  modeText.textContent = 'PRO';
  
  if (toggleBtn) {
   toggleBtn.addEventListener('click', () => {
    isProMode = !isProMode;
    
    if (isProMode) {
     document.body.classList.remove('basic-mode');
     toggleBtn.classList.add('pro');
     toggleBtn.classList.remove('basic');
     modeIcon.textContent = '‚ö°';
     modeText.textContent = 'PRO';
    } else {
     document.body.classList.add('basic-mode');
     toggleBtn.classList.remove('pro');
     toggleBtn.classList.add('basic');
     modeIcon.textContent = 'üìä';
     modeText.textContent = 'B√ÅSICO';
    }
   });
  }
 },
 
 obterDadosFiltrados() {
  return this.dados.filter(d =>
   d.ano === filtroAno.value &&
   (filtroMes.value === "ALL" || d.mes === filtroMes.value) &&
   (filtroSemana.value === "ALL" || d.semana === filtroSemana.value)
  );
 },
 
 atualizar() {
  const dadosFiltrados = this.obterDadosFiltrados();
  this.renderizarKPIs(dadosFiltrados);
  this.renderizarTabela(dadosFiltrados);
  this.renderizarGraficos(dadosFiltrados);
  this.renderizarCalendario(dadosFiltrados);
 },
 
 renderizarKPIs(dados) {
  const totais = dados.reduce((acc, d) => ({
   trades: acc.trades + d.trades,
   pontos: acc.pontos + d.pontos,
   gain: acc.gain + d.gain,
   stop: acc.stop + d.stop,
   zero: acc.zero + d.zero
  }), { trades: 0, pontos: 0, gain: 0, stop: 0, zero: 0 });
  
  const operacoes = totais.gain + totais.stop;
  const assertividade = operacoes ? Math.round((totais.gain / operacoes) * 100) : 0;
  const diasOperados = dados.filter(d => d.trades > 0).length;
  
  const contratos = parseInt(document.getElementById('contratos')?.value) || 0;
  const totalDolar = contratos === 0 ? 0 : totais.pontos * contratos * 2;
  
  document.getElementById("kDias").textContent = diasOperados;
  document.getElementById("kTrades").textContent = totais.trades;
  document.getElementById("kPontos").textContent = totais.pontos;
  document.getElementById("kAcc").textContent = assertividade + "%";
  
  const kDolar = document.getElementById("kDolar");
  if (kDolar) {
   kDolar.textContent = totalDolar.toLocaleString('en-US', {style: 'currency', currency: 'USD'});
   kDolar.style.color = totalDolar >= 0 ? 'var(--green)' : 'var(--red)';
  }
  
  document.getElementById("kGains").textContent = totais.gain;
  document.getElementById("kStops").textContent = totais.stop;
  document.getElementById("kZero").textContent = totais.zero;
 },
 
 renderizarTabela(dados) {
  let html = '';
  let tot = {p:0, t:0, g:0, s:0, z:0};
  
  dados.forEach(d => {
   tot.p += d.pontos; tot.t += d.trades;
   tot.g += d.gain; tot.s += d.stop; tot.z += d.zero;
   
   html += `
    <tr>
     <td>${d.dia}</td>
     <td style="color:${d.pontos<0?'var(--red)':'var(--green)'}">${d.pontos}</td>
     <td>${d.trades}</td>
     <td>${d.gain}</td>
     <td>${d.stop}</td>
     <td>${d.zero}</td>
     <td>${d.ativo}</td>
     <td>${d.semana}</td>
    </tr>`;
  });
  
  html += `
   <tr class="total">
    <td>TOTAL</td><td>${tot.p}</td><td>${tot.t}</td>
    <td>${tot.g}</td><td>${tot.s}</td><td>${tot.z}</td>
    <td colspan="2"></td>
   </tr>`;
  
  document.getElementById('tbody').innerHTML = html;
 },
 
 renderizarGraficos(dados) {
  let saldo = 0;
  const labels = [];
  const acumulado = [0];
  
  dados.forEach(d => {
   saldo += d.pontos;
   labels.push(d.dia);
   acumulado.push(saldo);
  });
  
  if (this.chartAcumulado) this.chartAcumulado.destroy();
  if (this.chartBar) this.chartBar.destroy();
  
  const ctxAc = document.getElementById('chartAcumulado');
  const ctxBar = document.getElementById('chartBar');
  
  if (ctxAc) {
   this.chartAcumulado = new Chart(ctxAc, {
    type: 'line',
    data: {
     labels: ['In√≠cio', ...labels],
     datasets: [{
      data: acumulado,
      borderColor: '#22c55e',
      backgroundColor: 'rgba(34,197,94,0.1)',
      fill: true,
      tension: 0.35,
      borderWidth: 2
     }]
    },
    options: {
     responsive: true,
     maintainAspectRatio: false,
     plugins: { legend: { display: false } },
     scales: {
      y: { ticks: { color: '#9ca3af' }, grid: { color: 'rgba(255,255,255,0.05)' } },
      x: { ticks: { color: '#9ca3af' }, grid: { color: 'rgba(255,255,255,0.05)' } }
     }
    }
   });
  }
  
  if (ctxBar) {
   this.chartBar = new Chart(ctxBar, {
    type: 'bar',
    data: {
     labels: ['Gain', 'Stop', '0x0'],
     datasets: [{
      data: [
       dados.reduce((a,b) => a+b.gain, 0),
       dados.reduce((a,b) => a+b.stop, 0),
       dados.reduce((a,b) => a+b.zero, 0)
      ],
      backgroundColor: ['#22c55e', '#ef4444', '#facc15'],
      borderRadius: 8
     }]
    },
    options: {
     responsive: true,
     maintainAspectRatio: false,
     plugins: { legend: { display: false } },
     scales: {
      y: { ticks: { color: '#9ca3af' }, grid: { color: 'rgba(255,255,255,0.05)' } },
      x: { ticks: { color: '#9ca3af' }, grid: { display: false } }
     }
    }
   });
  }
 },
 
 renderizarCalendario(dados) {
  const grid = document.getElementById("calendar");
  if (!grid) return;
  
  grid.innerHTML = "";
  if (!dados.length) return;
  
  let base = dados[0];
  if (filtroMes.value !== "ALL") {
   base = dados.find(d => d.mes === filtroMes.value) || dados[0];
  }
  
  const ano = base.data.getFullYear();
  const mes = base.data.getMonth();
  const primeiro = new Date(ano, mes, 1);
  const ultimo = new Date(ano, mes+1, 0);
  
  for (let i = 0; i < primeiro.getDay(); i++) {
   grid.innerHTML += `<div class="day empty"></div>`;
  }
  
  for (let d = 1; d <= ultimo.getDate(); d++) {
   const data = new Date(ano, mes, d);
   const r = dados.find(x => x.data.toDateString() === data.toDateString());
   let cls = "day", pts = "", info = "", badge = "";
   
   if (r) {
    pts = r.pontos;
    if (pts > 0) cls += " positive";
    if (pts < 0) cls += " negative";
    
    let infoParts = [];
    infoParts.push(`Trades: ${r.trades}`);
    if (r.gain > 0) infoParts.push(`Gain:${r.gain}`);
    if (r.stop > 0) infoParts.push(`Stop:${r.stop}`);
    if (r.zero > 0) infoParts.push(`0x0:${r.zero}`);
    info = infoParts.join('<br>');
    
    badge = `<div class="day-badge">${r.semana} | ${r.ativo}</div>`;
   }
   
   grid.innerHTML += `
    <div class="${cls}">
     <div class="day-number">${d}</div>
     <div class="day-points"
      style="color:${pts<0?'var(--red)':pts>0?'var(--green)':'var(--muted)'}">
      ${pts??""}
     </div>
     <div class="day-info">${info}</div>
     ${badge}
    </div>`;
  }
 }
};

Dashboard.init();
</script>
</body>
</html>
