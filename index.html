<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Calendário Trader</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
 --bg:#020617;
 --card:#0b1220;
 --border:rgba(255,255,255,.08);
 --text:#e5e7eb;
 --muted:#9ca3af;
 --green:#22c55e;
 --red:#ef4444;
 --blue:#60a5fa;
}

*{box-sizing:border-box;font-family:Inter,system-ui;}

body{
 margin:0;
 background:linear-gradient(180deg,#020617,#020617);
 color:var(--text);
 padding:24px;
}

.calendar{
 max-width:1100px;
 margin:auto;
}

.calendar-header{
 display:grid;
 grid-template-columns:repeat(7,1fr);
 text-align:center;
 font-size:13px;
 color:var(--muted);
 margin-bottom:12px;
}

.calendar-grid{
 display:grid;
 grid-template-columns:repeat(7,1fr);
 gap:12px;
}

.day{
 position:relative;
 background:linear-gradient(180deg,#0b1220,#020617);
 border:1px solid var(--border);
 border-radius:14px;
 height:120px;
 padding:10px;
 cursor:pointer;
 transition:.2s;
}

.day:hover{
 border-color:var(--blue);
}

.day-number{
 font-size:15px;
 color:var(--muted);
}

.day-points{
 position:absolute;
 inset:0;
 display:flex;
 align-items:center;
 justify-content:center;
 font-size:28px;
 font-weight:800;
}

.day.positive .day-points{color:var(--green);}
.day.negative .day-points{color:var(--red);}

.empty{
 background:transparent;
 border:none;
 cursor:default;
}

/* OVERLAY */
.overlay{
 position:fixed;
 top:0;right:0;
 width:380px;
 height:100%;
 background:#020617;
 border-left:1px solid var(--border);
 padding:20px;
 transform:translateX(100%);
 transition:.3s;
 z-index:10;
}

.overlay.open{transform:translateX(0);}

.overlay h2{
 margin:0 0 10px;
 font-size:18px;
}

.close{
 position:absolute;
 top:12px;
 right:14px;
 cursor:pointer;
 color:var(--muted);
}

.section{
 margin-top:16px;
}

.stats{
 font-size:14px;
 line-height:1.5;
}

.checklist label{
 display:flex;
 gap:8px;
 margin:6px 0;
 font-size:14px;
}

textarea{
 width:100%;
 min-height:90px;
 background:#0b1220;
 border:1px solid var(--border);
 border-radius:10px;
 color:var(--text);
 padding:10px;
 resize:none;
}

button{
 margin-top:10px;
 width:100%;
 padding:10px;
 border:none;
 border-radius:10px;
 background:var(--blue);
 color:#020617;
 font-weight:700;
 cursor:pointer;
}
</style>
</head>

<body>

<div class="calendar">
 <h1>Calendário Trader</h1>

 <div class="calendar-header">
  <div>Dom</div><div>Seg</div><div>Ter</div>
  <div>Qua</div><div>Qui</div><div>Sex</div><div>Sáb</div>
 </div>

 <div class="calendar-grid" id="calendar"></div>
</div>

<div class="overlay" id="overlay">
 <div class="close" onclick="closeOverlay()">✕</div>
 <h2 id="overlay-date"></h2>

 <div class="section stats" id="overlay-stats"></div>

 <div class="section checklist">
  <strong>Checklist</strong>
  <label><input type="checkbox" data-tag="plano"> Seguiu o plano</label>
  <label><input type="checkbox" data-tag="regra"> Quebrou regra</label>
  <label><input type="checkbox" data-tag="emocional"> Emocional afetou</label>
  <label><input type="checkbox" data-tag="overtrade"> Overtrade</label>
 </div>

 <div class="section">
  <strong>Observações</strong>
  <textarea id="obs"></textarea>
  <button onclick="salvarObs()">Salvar</button>
 </div>
</div>

<script>
const grid=document.getElementById("calendar");
const overlay=document.getElementById("overlay");
let selectedDate="";

const dados={
 "2024-01-10":{pontos:73,trades:1,gain:1},
 "2024-01-11":{pontos:-27,trades:2,stop:2},
 "2024-01-12":{pontos:55,trades:1,gain:1}
};

function montar(){
 const hoje=new Date();
 const ano=hoje.getFullYear();
 const mes=hoje.getMonth();
 const primeiro=new Date(ano,mes,1).getDay();
 const total=new Date(ano,mes+1,0).getDate();

 for(let i=0;i<primeiro;i++){
  grid.innerHTML+=`<div class="day empty"></div>`;
 }

 for(let d=1;d<=total;d++){
  const data=`${ano}-${String(mes+1).padStart(2,"0")}-${String(d).padStart(2,"0")}`;
  const r=dados[data];
  let cls="day";
  if(r){
   if(r.pontos>0)cls+=" positive";
   if(r.pontos<0)cls+=" negative";
  }
  grid.innerHTML+=`
   <div class="${cls}" onclick="openOverlay('${data}')">
    <div class="day-number">${d}</div>
    <div class="day-points">${r?r.pontos:""}</div>
   </div>`;
 }
}

function openOverlay(data){
 selectedDate=data;
 overlay.classList.add("open");
 document.getElementById("overlay-date").innerText=data;

 const r=dados[data]||{};
 let html="";
 if(r.trades)html+=`Trades: ${r.trades}<br>`;
 if(r.gain)html+=`Gain: ${r.gain} `;
 if(r.stop)html+=`Stop: ${r.stop}`;

 document.getElementById("overlay-stats").innerHTML=html||"Sem dados";

 const saved=JSON.parse(localStorage.getItem("obs-"+data)||"{}");
 document.getElementById("obs").value=saved.text||"";
 document.querySelectorAll(".checklist input").forEach(c=>{
  c.checked=saved[c.dataset.tag]||false;
 });
}

function closeOverlay(){
 overlay.classList.remove("open");
}

function salvarObs(){
 const data={
  text:document.getElementById("obs").value
 };
 document.querySelectorAll(".checklist input").forEach(c=>{
  data[c.dataset.tag]=c.checked;
 });
 localStorage.setItem("obs-"+selectedDate,JSON.stringify(data));
}

montar();
</script>

</body>
</html>
