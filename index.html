<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Dashboard NASDAQ PRO - Premium Edition</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
<meta name="theme-color" content="#050711">
<meta name="mobile-web-app-capable" content="yes">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Archivo:wght@400;600;700;900&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
<style>
:root {
 --sidebar-bg: #0a0d1a;
 --main-bg: #050711;
 --card-bg: #0f1420;
 --card-hover: #161b2e;
 --border: rgba(99,102,241,0.15);
 --border-bright: rgba(99,102,241,0.4);
 --text: #f8fafc;
 --text-dim: #cbd5e1;
 --muted: #64748b;
 --green: #10b981;
 --green-glow: rgba(16,185,129,0.3);
 --red: #ef4444;
 --red-glow: rgba(239,68,68,0.3);
 --yellow: #fbbf24;
 --blue: #6366f1;
 --blue-bright: #818cf8;
 --purple: #a855f7;
 --orange: #f97316;
 --cyan: #06b6d4;
 
 --shadow-sm: 0 2px 8px rgba(0,0,0,0.3);
 --shadow-md: 0 4px 16px rgba(0,0,0,0.4);
 --shadow-lg: 0 8px 32px rgba(0,0,0,0.5);
 --shadow-glow: 0 0 20px rgba(99,102,241,0.4);
}

* {
 margin: 0;
 padding: 0;
 box-sizing: border-box;
}

body {
 font-family: 'Archivo', -apple-system, BlinkMacSystemFont, sans-serif;
 background: var(--main-bg);
 color: var(--text);
 display: flex;
 justify-content: center;
 min-height: 100vh;
 overflow-x: hidden;
 position: relative;
}

body::before {
 content: '';
 position: fixed;
 top: 0;
 left: 0;
 right: 0;
 bottom: 0;
 background: 
  radial-gradient(circle at 20% 50%, rgba(99,102,241,0.08) 0%, transparent 50%),
  radial-gradient(circle at 80% 80%, rgba(168,85,247,0.08) 0%, transparent 50%);
 pointer-events: none;
 z-index: 0;
}

.dashboard-container {
 display: flex;
 max-width: 1800px;
 width: 100%;
 min-height: 100vh;
 position: relative;
 z-index: 1;
}

/* ========== SIDEBAR ========== */
.sidebar {
 width: 280px;
 background: var(--sidebar-bg);
 padding: 32px 20px;
 border-right: 1px solid var(--border);
 overflow-y: auto;
 display: flex;
 flex-direction: column;
 flex-shrink: 0;
 position: relative;
}

.sidebar::before {
 content: '';
 position: absolute;
 top: 0;
 right: 0;
 width: 1px;
 height: 100%;
 background: linear-gradient(180deg, transparent, var(--blue), transparent);
 opacity: 0.5;
}

.logo {
 display: flex;
 align-items: center;
 justify-content: center;
 margin-bottom: 40px;
 padding: 20px;
 background: linear-gradient(135deg, rgba(99,102,241,0.1), rgba(168,85,247,0.1));
 border-radius: 16px;
 border: 1px solid var(--border);
 transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.logo:hover {
 transform: translateY(-2px);
 box-shadow: var(--shadow-glow);
 border-color: var(--border-bright);
}

.logo img {
 max-height: 80px;
 width: auto;
 max-width: 100%;
 filter: drop-shadow(0 4px 12px rgba(99,102,241,0.4));
}

.filters {
 margin-bottom: 24px;
 animation: slideInLeft 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

@keyframes slideInLeft {
 from {
  opacity: 0;
  transform: translateX(-20px);
 }
 to {
  opacity: 1;
  transform: translateX(0);
 }
}

.filter-group {
 margin-bottom: 20px;
}

.filter-group label {
 display: block;
 font-size: 12px;
 text-transform: uppercase;
 letter-spacing: 1.5px;
 color: var(--text-dim);
 margin-bottom: 10px;
 font-weight: 700;
}

.filter-group select {
 width: 100%;
 background: var(--card-bg);
 color: var(--text);
 border: 1px solid var(--border);
 padding: 14px 16px;
 border-radius: 12px;
 font-size: 15px;
 font-weight: 600;
 cursor: pointer;
 transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
 font-family: 'JetBrains Mono', monospace;
}

.filter-group select:hover {
 border-color: var(--blue-bright);
 background: var(--card-hover);
 transform: translateY(-1px);
}

.filter-group select:focus {
 outline: none;
 border-color: var(--blue);
 box-shadow: 0 0 0 4px rgba(99,102,241,0.15);
}

.filter-group select:disabled {
 opacity: 0.4;
 cursor: not-allowed;
 transform: none;
}

.stats-sidebar {
 margin-top: 24px;
 padding-top: 24px;
 border-top: 1px solid var(--border);
 animation: fadeIn 0.8s cubic-bezier(0.4, 0, 0.2, 1) 0.3s both;
}

@keyframes fadeIn {
 from { opacity: 0; }
 to { opacity: 1; }
}

.sidebar-stat {
 display: flex;
 justify-content: space-between;
 align-items: center;
 padding: 14px;
 margin-bottom: 10px;
 background: rgba(99,102,241,0.05);
 border-radius: 10px;
 font-size: 14px;
 transition: all 0.2s;
}

.sidebar-stat:hover {
 background: rgba(99,102,241,0.1);
 transform: translateX(4px);
}

.sidebar-stat span:first-child {
 color: var(--text-dim);
 font-weight: 600;
}

.sidebar-stat span:last-child {
 color: var(--text);
 font-weight: 800;
 font-family: 'JetBrains Mono', monospace;
 font-size: 15px;
}

.mode-toggle {
 width: 100%;
 background: linear-gradient(135deg, var(--blue) 0%, var(--purple) 100%);
 color: white;
 border: none;
 padding: 18px 20px;
 border-radius: 14px;
 font-weight: 800;
 font-size: 15px;
 cursor: pointer;
 transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
 display: grid;
 grid-template-columns: 20px 1fr;
 align-items: center;
 justify-items: center;
 gap: 0;
 letter-spacing: 1px;
 position: relative;
 overflow: hidden;
 box-shadow: 0 4px 12px rgba(99,102,241,0.3);
}

.mode-toggle span {
 display: inline-block;
}

.mode-toggle #modeIcon {
 font-size: 18px;
 line-height: 1;
 justify-self: end;
}

.mode-toggle #modeText {
 font-size: 15px;
 font-weight: 800;
 letter-spacing: 1px;
 justify-self: start;
 margin-left: 8px;
}

.mode-toggle::before {
 content: '';
 position: absolute;
 top: 0;
 left: -100%;
 width: 100%;
 height: 100%;
 background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
 transition: left 0.5s;
}

.mode-toggle:hover::before {
 left: 100%;
}

.mode-toggle:hover {
 transform: translateY(-3px);
 box-shadow: 0 12px 28px rgba(99,102,241,0.5);
}

.mode-toggle:active {
 transform: translateY(-1px);
}

.mode-toggle.basic {
 background: linear-gradient(135deg, var(--cyan) 0%, var(--blue) 100%);
}

/* ========== MAIN CONTENT ========== */
.main-content {
 flex: 1;
 padding: 32px 40px;
 overflow-y: auto;
 overflow-x: hidden;
}

.header-main {
 margin-bottom: 36px;
 animation: fadeIn 0.5s cubic-bezier(0.4, 0, 0.2, 1);
}

.header-main h1 {
 font-size: 46px;
 font-weight: 900;
 background: linear-gradient(135deg, var(--text) 0%, var(--blue-bright) 100%);
 -webkit-background-clip: text;
 -webkit-text-fill-color: transparent;
 background-clip: text;
 margin-bottom: 12px;
 letter-spacing: -1px;
}

.header-main p {
 font-size: 16px;
 color: var(--text-dim);
 font-weight: 500;
}

/* ========== CARDS ========== */
.cards-container {
 display: grid;
 grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
 gap: 24px;
 margin-bottom: 32px;
}

.card {
 background: var(--card-bg);
 border: 1px solid var(--border);
 border-radius: 20px;
 padding: 28px;
 transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
 position: relative;
 overflow: hidden;
 animation: fadeIn 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.card::before {
 content: '';
 position: absolute;
 top: 0;
 left: 0;
 right: 0;
 height: 3px;
 background: linear-gradient(90deg, var(--blue), var(--purple));
 transform: scaleX(0);
 transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.card:hover::before {
 transform: scaleX(1);
}

.card:hover {
 transform: translateY(-6px);
 border-color: var(--border-bright);
 box-shadow: var(--shadow-lg), 0 0 30px rgba(99,102,241,0.2);
}

.card-header {
 display: flex;
 justify-content: space-between;
 align-items: flex-start;
 margin-bottom: 24px;
}

.card-title {
 font-size: 14px;
 font-weight: 700;
 text-transform: uppercase;
 letter-spacing: 1.5px;
 color: var(--text-dim);
}

.card-icon {
 font-size: 28px;
 opacity: 0.6;
 transition: all 0.3s;
}

.card:hover .card-icon {
 opacity: 1;
 transform: scale(1.1) rotate(5deg);
}

.card-value {
 font-size: 48px;
 font-weight: 900;
 font-family: 'JetBrains Mono', monospace;
 margin-bottom: 12px;
 line-height: 1;
}

.card-value.positive { color: var(--green); text-shadow: 0 0 20px var(--green-glow); }
.card-value.negative { color: var(--red); text-shadow: 0 0 20px var(--red-glow); }
.card-value.neutral { color: var(--text-dim); }

.card-subtitle {
 font-size: 14px;
 color: var(--muted);
 font-weight: 600;
}

.card-breakdown {
 display: grid;
 grid-template-columns: repeat(3, 1fr);
 gap: 16px;
 margin-top: 20px;
 padding-top: 20px;
 border-top: 1px solid var(--border);
}

.breakdown-item {
 text-align: center;
 padding: 12px;
 background: rgba(99,102,241,0.05);
 border-radius: 12px;
 transition: all 0.2s;
}

.breakdown-item:hover {
 background: rgba(99,102,241,0.1);
 transform: translateY(-2px);
}

.breakdown-label {
 font-size: 11px;
 text-transform: uppercase;
 letter-spacing: 1px;
 color: var(--muted);
 margin-bottom: 6px;
 font-weight: 700;
}

.breakdown-value {
 font-size: 22px;
 font-weight: 900;
 font-family: 'JetBrains Mono', monospace;
}

.breakdown-value.gain { color: var(--green); }
.breakdown-value.stop { color: var(--red); }
.breakdown-value.zero { color: var(--yellow); }

/* Card Total em D√≥lar com Convers√£o */
.card-value-with-currency {
 display: flex;
 align-items: center;
 gap: 16px;
 margin-bottom: 12px;
}

.currency-toggle {
 background: transparent;
 border: 2px solid var(--border);
 border-radius: 12px;
 padding: 8px 12px;
 cursor: pointer;
 transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
 font-size: 24px;
 display: flex;
 align-items: center;
 gap: 6px;
 position: relative;
}

.currency-toggle:hover {
 border-color: var(--blue-bright);
 background: rgba(99,102,241,0.1);
 transform: scale(1.05);
}

.currency-toggle.active {
 border-color: var(--green);
 background: rgba(16,185,129,0.1);
}

.currency-label {
 font-size: 11px;
 font-weight: 700;
 color: var(--text-dim);
 text-transform: uppercase;
 letter-spacing: 1px;
 margin-bottom: 4px;
}

.currency-rate {
 font-size: 11px;
 color: var(--muted);
 margin-top: 4px;
 font-family: 'JetBrains Mono', monospace;
}

/* ========== GR√ÅFICO ========== */
.chart-container {
 background: var(--card-bg);
 border: 1px solid var(--border);
 border-radius: 20px;
 padding: 32px;
 margin-bottom: 32px;
 transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
 animation: fadeIn 0.7s cubic-bezier(0.4, 0, 0.2, 1) 0.2s both;
}

.chart-container:hover {
 border-color: var(--border-bright);
 box-shadow: var(--shadow-md);
}

.chart-container h2 {
 font-size: 20px;
 font-weight: 800;
 margin-bottom: 24px;
 color: var(--text);
 letter-spacing: -0.5px;
}

/* ========== CALEND√ÅRIO ========== */
.calendar-container {
 background: var(--card-bg);
 border: 1px solid var(--border);
 border-radius: 20px;
 padding: 32px;
 animation: fadeIn 0.8s cubic-bezier(0.4, 0, 0.2, 1) 0.3s both;
 transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.calendar-container:hover {
 border-color: var(--border-bright);
 box-shadow: var(--shadow-md);
}

.calendar-header {
 display: flex;
 justify-content: space-between;
 align-items: center;
 margin-bottom: 32px;
 flex-wrap: wrap;
 gap: 16px;
}

.calendar-header h2 {
 font-size: 20px;
 font-weight: 800;
 color: var(--text);
 letter-spacing: -0.5px;
 display: flex;
 align-items: center;
 gap: 12px;
}

.back-to-months-btn {
 background: linear-gradient(135deg, var(--blue), var(--purple));
 color: white;
 border: none;
 padding: 10px 20px;
 border-radius: 10px;
 font-weight: 700;
 font-size: 13px;
 cursor: pointer;
 transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
 letter-spacing: 0.5px;
 box-shadow: 0 4px 12px rgba(99,102,241,0.3);
}

.back-to-months-btn:hover {
 transform: translateY(-2px);
 box-shadow: 0 8px 20px rgba(99,102,241,0.4);
}

.legend {
 display: flex;
 gap: 20px;
 flex-wrap: wrap;
}

.legend-item {
 display: flex;
 align-items: center;
 gap: 8px;
 font-size: 13px;
 font-weight: 600;
 color: var(--text-dim);
}

.legend-color {
 width: 16px;
 height: 16px;
 border-radius: 4px;
 box-shadow: 0 2px 6px rgba(0,0,0,0.3);
}

.legend-color.gain { background: var(--green); }
.legend-color.stop { background: var(--red); }
.legend-color.zero { background: var(--yellow); }

.calendar-grid {
 display: grid;
 grid-template-columns: repeat(7, 1fr);
 gap: 12px;
}

/* Seletor de meses */
.month-card {
 background: var(--card-bg);
 border: 2px solid var(--border);
 border-radius: 16px;
 padding: 24px;
 text-align: center;
 cursor: pointer;
 transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
 position: relative;
 overflow: hidden;
}

.month-card::before {
 content: '';
 position: absolute;
 top: 0;
 left: 0;
 right: 0;
 height: 4px;
 background: linear-gradient(90deg, var(--blue), var(--purple));
 transform: scaleX(0);
 transition: transform 0.3s;
}

.month-card:hover {
 transform: translateY(-8px);
 border-color: var(--blue-bright);
 box-shadow: var(--shadow-lg), 0 0 30px rgba(99,102,241,0.3);
}

.month-card:hover::before {
 transform: scaleX(1);
}

.month-card.positive {
 border-color: var(--green);
 background: rgba(16,185,129,0.05);
}

.month-card.negative {
 border-color: var(--red);
 background: rgba(239,68,68,0.05);
}

.month-name {
 font-size: 22px;
 font-weight: 800;
 margin-bottom: 12px;
 color: var(--text);
}

.month-points {
 font-size: 42px;
 font-weight: 900;
 font-family: 'JetBrains Mono', monospace;
 margin-bottom: 8px;
}

.month-info {
 font-size: 13px;
 color: var(--muted);
 font-weight: 600;
}

/* Dias do calend√°rio */
.day {
 background: var(--card-bg);
 border: 2px solid var(--border);
 border-radius: 14px;
 padding: 16px 12px;
 text-align: center;
 transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
 position: relative;
 min-height: 120px;
 display: flex;
 flex-direction: column;
 justify-content: space-between;
}

.day:hover {
 transform: translateY(-4px);
 border-color: var(--blue-bright);
 box-shadow: var(--shadow-md);
}

.day.clickable {
 cursor: pointer;
}

.day.clickable::after {
 content: 'üîç';
 position: absolute;
 top: 8px;
 right: 8px;
 font-size: 14px;
 opacity: 0;
 transition: opacity 0.2s;
}

.day.clickable:hover::after {
 opacity: 1;
}

.day.positive {
 border-color: var(--green);
 background: rgba(16,185,129,0.05);
}

.day.positive:hover {
 box-shadow: 0 8px 24px var(--green-glow);
}

.day.negative {
 border-color: var(--red);
 background: rgba(239,68,68,0.05);
}

.day.negative:hover {
 box-shadow: 0 8px 24px var(--red-glow);
}

.day.empty {
 background: transparent;
 border: none;
 pointer-events: none;
}

.day-number {
 font-size: 16px;
 font-weight: 800;
 color: var(--text-dim);
 margin-bottom: 8px;
}

.day-points {
 font-size: 28px;
 font-weight: 900;
 font-family: 'JetBrains Mono', monospace;
 margin-bottom: 8px;
}

.day-info {
 font-size: 11px;
 color: var(--muted);
 line-height: 1.4;
 font-weight: 600;
}

.day-badge {
 position: absolute;
 bottom: 8px;
 left: 50%;
 transform: translateX(-50%);
 background: rgba(99,102,241,0.2);
 padding: 4px 10px;
 border-radius: 8px;
 font-size: 10px;
 font-weight: 700;
 color: var(--blue-bright);
 letter-spacing: 0.5px;
 white-space: nowrap;
}

/* ========== MODAL DE FOTO ========== */
.modal-overlay {
 position: fixed;
 top: 0;
 left: 0;
 right: 0;
 bottom: 0;
 background: rgba(0, 0, 0, 0.95);
 backdrop-filter: blur(10px);
 z-index: 9999;
 display: none;
 align-items: center;
 justify-content: center;
 padding: 20px;
 animation: fadeIn 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.modal-overlay.active {
 display: flex;
}

.modal-content {
 background: var(--card-bg);
 border: 2px solid var(--border-bright);
 border-radius: 24px;
 max-width: 1400px;
 width: 100%;
 max-height: 95vh;
 display: grid;
 grid-template-columns: 300px 1fr;
 overflow: hidden;
 box-shadow: 0 20px 60px rgba(0,0,0,0.5), 0 0 100px rgba(99,102,241,0.3);
 animation: modalZoom 0.4s cubic-bezier(0.4, 0, 0.2, 1);
 position: relative;
}

@keyframes modalZoom {
 from {
  opacity: 0;
  transform: scale(0.9);
 }
 to {
  opacity: 1;
  transform: scale(1);
 }
}

.modal-close {
 position: absolute;
 top: 20px;
 right: 20px;
 background: rgba(239,68,68,0.2);
 border: 2px solid var(--red);
 color: white;
 width: 44px;
 height: 44px;
 border-radius: 12px;
 font-size: 24px;
 cursor: pointer;
 display: flex;
 align-items: center;
 justify-content: center;
 transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
 z-index: 10;
 font-weight: 700;
}

.modal-close:hover {
 background: var(--red);
 transform: scale(1.1) rotate(90deg);
 box-shadow: 0 8px 24px var(--red-glow);
}

.modal-info {
 background: var(--sidebar-bg);
 padding: 32px 24px;
 border-right: 2px solid var(--border);
 overflow-y: auto;
}

.modal-info h3 {
 font-size: 22px;
 font-weight: 900;
 margin-bottom: 24px;
 color: var(--text);
 padding-bottom: 16px;
 border-bottom: 2px solid var(--border);
}

.modal-info-grid {
 display: flex;
 flex-direction: column;
 gap: 16px;
}

.modal-info-item {
 background: rgba(99,102,241,0.05);
 padding: 16px;
 border-radius: 12px;
 border: 1px solid var(--border);
 transition: all 0.2s;
}

.modal-info-item:hover {
 background: rgba(99,102,241,0.1);
 border-color: var(--blue-bright);
 transform: translateX(4px);
}

.modal-info-item label {
 display: block;
 font-size: 11px;
 text-transform: uppercase;
 letter-spacing: 1.2px;
 color: var(--text-dim);
 margin-bottom: 8px;
 font-weight: 700;
}

.modal-info-item .value {
 font-size: 28px;
 font-weight: 900;
 font-family: 'JetBrains Mono', monospace;
 color: var(--text);
}

.modal-photo-container {
 display: flex;
 align-items: center;
 justify-content: center;
 padding: 32px;
 overflow: hidden;
 position: relative;
 background: var(--main-bg);
}

.modal-photo-container img {
 max-width: 100%;
 max-height: calc(95vh - 64px);
 width: auto;
 height: auto;
 object-fit: contain;
 border-radius: 16px;
 box-shadow: 0 20px 60px rgba(0,0,0,0.4);
 cursor: zoom-in;
 transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.modal-photo-container img.zoomed {
 cursor: zoom-out;
 transform: scale(2);
 max-width: none;
 max-height: none;
}

.modal-photo-loading,
.modal-photo-error {
 display: flex;
 flex-direction: column;
 align-items: center;
 justify-content: center;
 gap: 16px;
 color: var(--text-dim);
 font-size: 16px;
 font-weight: 600;
 padding: 60px;
 text-align: center;
}

.modal-photo-spinner {
 width: 50px;
 height: 50px;
 border: 4px solid var(--border);
 border-top-color: var(--blue);
 border-radius: 50%;
 animation: spin 1s linear infinite;
}

@keyframes spin {
 to { transform: rotate(360deg); }
}

.modal-photo-error {
 color: var(--red);
}

/* Zoom controls */
.zoom-controls {
 position: absolute;
 bottom: 32px;
 right: 32px;
 display: flex;
 gap: 12px;
 z-index: 10;
}

.zoom-btn {
 background: rgba(99,102,241,0.9);
 border: 2px solid var(--blue-bright);
 color: white;
 width: 48px;
 height: 48px;
 border-radius: 12px;
 font-size: 24px;
 cursor: pointer;
 display: flex;
 align-items: center;
 justify-content: center;
 transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
 font-weight: 700;
 backdrop-filter: blur(10px);
}

.zoom-btn:hover {
 background: var(--blue);
 transform: scale(1.1);
 box-shadow: 0 8px 24px rgba(99,102,241,0.5);
}

.zoom-btn:active {
 transform: scale(0.95);
}

/* ========== RESPONSIVIDADE ========== */
@media (max-width: 1200px) {
 .dashboard-container { flex-direction: column; }
 .sidebar { width: 100%; border-right: none; border-bottom: 1px solid var(--border); }
 .main-content { padding: 24px 20px; }
 .modal-content { grid-template-columns: 1fr; max-height: 90vh; }
 .modal-info { border-right: none; border-bottom: 2px solid var(--border); }
}

@media (max-width: 768px) {
 .header-main h1 { font-size: 32px; }
 .cards-container { grid-template-columns: 1fr; }
 .calendar-grid { grid-template-columns: repeat(7, 1fr); gap: 6px; }
 .day { min-height: 90px; padding: 10px 6px; }
 .day-points { font-size: 20px; }
 .day-info { font-size: 9px; }
 .modal-close { top: 10px; right: 10px; width: 36px; height: 36px; font-size: 20px; }
 .zoom-controls { bottom: 20px; right: 20px; }
 .zoom-btn { width: 40px; height: 40px; font-size: 20px; }
}

/* ========== LOADING ========== */
.loading-overlay {
 position: fixed;
 top: 0;
 left: 0;
 right: 0;
 bottom: 0;
 background: var(--main-bg);
 display: flex;
 flex-direction: column;
 align-items: center;
 justify-content: center;
 z-index: 10000;
 gap: 24px;
}

.loading-spinner {
 width: 70px;
 height: 70px;
 border: 5px solid var(--border);
 border-top-color: var(--blue);
 border-radius: 50%;
 animation: spin 1s linear infinite;
}

.loading-text {
 font-size: 18px;
 font-weight: 700;
 color: var(--text-dim);
 letter-spacing: 1px;
}

.hide { display: none !important; }
</style>
</head>
<body>

<div class="loading-overlay" id="loadingOverlay">
 <div class="loading-spinner"></div>
 <div class="loading-text">Carregando Dashboard...</div>
</div>

<div class="dashboard-container">
 <!-- SIDEBAR -->
 <aside class="sidebar">
  <div class="logo">
   <img src="https://i.postimg.cc/xTtKr04k/log6.png" alt="Logo NASDAQ PRO">
  </div>
  
  <div class="filters">
   <div class="filter-group">
    <label for="filterAno">üìÖ Ano</label>
    <select id="filterAno"></select>
   </div>
   
   <div class="filter-group">
    <label for="filterMes">üìÜ M√™s</label>
    <select id="filterMes">
     <option value="ALL">Todos os Meses</option>
    </select>
   </div>
   
   <div class="filter-group">
    <label for="filterSemana">üìä Semana</label>
    <select id="filterSemana" disabled>
     <option value="ALL">Todas</option>
    </select>
   </div>
   
   <div class="filter-group">
    <label for="filterAtivo">üíπ Ativo</label>
    <select id="filterAtivo">
     <option value="ALL">Todos</option>
    </select>
   </div>
  </div>
  
  <div class="stats-sidebar" id="statsSidebar"></div>
  
  <button class="mode-toggle" id="toggleMode">
   <span id="modeIcon">üî¨</span>
   <span id="modeText">MODO PRO</span>
  </button>
 </aside>
 
 <!-- MAIN CONTENT -->
 <main class="main-content">
  <div class="header-main">
   <h1 id="dashboardTitle">Performance NASDAQ</h1>
   <p id="dashboardSubtitle">An√°lise detalhada das opera√ß√µes</p>
  </div>
  
  <!-- CARDS DE RESUMO -->
  <div class="cards-container" id="cardsContainer"></div>
  
  <!-- GR√ÅFICO -->
  <div class="chart-container" id="chartContainer">
   <h2>üìà Evolu√ß√£o dos Pontos</h2>
   <canvas id="chart"></canvas>
  </div>
  
  <!-- CALEND√ÅRIO -->
  <div class="calendar-container">
   <div class="calendar-header">
    <h2 id="calendarTitle">üìÖ Calend√°rio de Opera√ß√µes</h2>
    <div class="legend">
     <div class="legend-item">
      <div class="legend-color gain"></div>
      <span>Gain</span>
     </div>
     <div class="legend-item">
      <div class="legend-color stop"></div>
      <span>Stop</span>
     </div>
     <div class="legend-item">
      <div class="legend-color zero"></div>
      <span>0x0</span>
     </div>
    </div>
   </div>
   <div class="calendar-grid" id="calendar"></div>
  </div>
 </main>
</div>

<!-- MODAL DE FOTO DO TRADE -->
<div class="modal-overlay" id="tradePhotoModal">
 <div class="modal-content">
  <button class="modal-close" onclick="Dashboard.fecharModal()">√ó</button>
  
  <div class="modal-info">
   <h3 id="modalTitle">Informa√ß√µes do Trade</h3>
   <div class="modal-info-grid" id="modalInfoGrid"></div>
  </div>
  
  <div class="modal-photo-container" id="modalPhotoContainer">
   <div class="modal-photo-loading">
    <div class="modal-photo-spinner"></div>
    Carregando foto...
   </div>
  </div>
  
  <div class="zoom-controls">
   <button class="zoom-btn" onclick="Dashboard.zoomOut()" title="Zoom Out">‚àí</button>
   <button class="zoom-btn" onclick="Dashboard.resetZoom()" title="Reset Zoom">‚ü≤</button>
   <button class="zoom-btn" onclick="Dashboard.zoomIn()" title="Zoom In">+</button>
  </div>
 </div>
</div>

<script>
const SHEET_ID = "1pq6rrC8MWqjCEEVDgxMbZ4y_wDr7gECpMWMU-1_UwE8";
const API_KEY = "AIzaSyDTRGixLHJsYGLmZm8Qh4tgLBqVeaJRNBo";
const RANGE = "A:I";

const nomesMeses = {
 "01":"Janeiro","02":"Fevereiro","03":"Mar√ßo","04":"Abril",
 "05":"Maio","06":"Junho","07":"Julho","08":"Agosto",
 "09":"Setembro","10":"Outubro","11":"Novembro","12":"Dezembro"
};

const filtroAno = document.getElementById("filterAno");
const filtroMes = document.getElementById("filterMes");
const filtroSemana = document.getElementById("filterSemana");
const filtroAtivo = document.getElementById("filterAtivo");
const toggleBtn = document.getElementById("toggleMode");
const cardsContainer = document.getElementById("cardsContainer");
const chartContainer = document.getElementById("chartContainer");

let myChart = null;
let currencyMode = 'USD'; // USD ou BRL
let exchangeRate = 5.00; // Taxa padr√£o, ser√° atualizada

// Buscar cota√ß√£o do d√≥lar em tempo real
async function buscarCotacaoDolar() {
 try {
  const response = await fetch('https://api.exchangerate-api.com/v4/latest/USD');
  const data = await response.json();
  exchangeRate = data.rates.BRL;
  console.log('üí± Cota√ß√£o atualizada: USD 1.00 = BRL ' + exchangeRate.toFixed(2));
  return exchangeRate;
 } catch (error) {
  console.warn('‚ö†Ô∏è Erro ao buscar cota√ß√£o, usando padr√£o:', exchangeRate);
  return exchangeRate;
 }
}

const Dashboard = {
 dados: [],
 dadosFiltrados: [],
 modoPro: true,
 primeiraCarga: true,
 zoomLevel: 1,
 zoomStep: 0.3,
 
 async init() {
  console.log('üöÄ Iniciando Dashboard...');
  await this.carregarDados();
  await buscarCotacaoDolar();
  this.configurarEventos();
  this.atualizar();
  document.getElementById('loadingOverlay').classList.add('hide');
 },
 
 async carregarDados() {
  const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${RANGE}?key=${API_KEY}`;
  
  try {
   const resp = await fetch(url);
   const json = await resp.json();
   const rows = json.values || [];
   
   if (rows.length < 2) {
    console.error('‚ùå Planilha vazia ou sem dados');
    return;
   }
   
   const header = rows[0];
   const dataRows = rows.slice(1);
   
   console.log('üìä Colunas encontradas:', header);
   console.log('üìã Total de linhas:', dataRows.length);
   
   this.dados = dataRows
    .filter(row => row[0] && row[0].includes('/'))
    .map(row => {
     const [dia, mes, ano] = row[0].split('/');
     const data = new Date(ano, mes - 1, dia);
     
     return {
      dia: row[0],
      data: data,
      ano: ano,
      mes: mes,
      semana: row[1] || "",
      trades: parseInt(row[2]) || 0,
      pontos: parseFloat(row[3]) || 0,
      ativo: row[4] || "",
      gain: parseInt(row[5]) || 0,
      stop: parseInt(row[6]) || 0,
      zero: parseInt(row[7]) || 0,
      fotoId: row[8] ? row[8].toString().trim() : ""
     };
    });
   
   console.log('‚úÖ Dados carregados:', this.dados.length, 'registros');
   
   this.inicializarFiltros();
   
  } catch (err) {
   console.error('‚ùå Erro ao carregar planilha:', err);
  }
 },
 
 inicializarFiltros() {
  const anos = [...new Set(this.dados.map(d => d.ano))].sort().reverse();
  const ativos = [...new Set(this.dados.map(d => d.ativo))].filter(Boolean).sort();
  
  filtroAno.innerHTML = anos.map(a => `<option value="${a}">${a}</option>`).join('');
  
  const mesesDoAno = [...new Set(this.dados.filter(d => d.ano === anos[0]).map(d => d.mes))].sort();
  filtroMes.innerHTML = '<option value="ALL">Todos os Meses</option>' +
   mesesDoAno.map(m => `<option value="${m}">${nomesMeses[m]}</option>`).join('');
  
  filtroAtivo.innerHTML = '<option value="ALL">Todos</option>' +
   ativos.map(a => `<option value="${a}">${a}</option>`).join('');
  
  if (this.primeiraCarga && mesesDoAno.length > 0) {
   const ultimoMes = mesesDoAno[mesesDoAno.length - 1];
   filtroMes.value = ultimoMes;
   this.primeiraCarga = false;
   filtroSemana.disabled = false;
   this.inicializarSemanas();
  }
 },
 
 inicializarSemanas() {
  const mesSelecionado = filtroMes.value;
  const anoSelecionado = filtroAno.value;
  
  if (mesSelecionado === "ALL") {
   filtroSemana.disabled = true;
   filtroSemana.innerHTML = '<option value="ALL">Todas</option>';
   return;
  }
  
  const semanas = [...new Set(
   this.dados
    .filter(d => d.ano === anoSelecionado && d.mes === mesSelecionado && d.semana)
    .map(d => d.semana)
  )].sort();
  
  filtroSemana.innerHTML = '<option value="ALL">Todas</option>' +
   semanas.map(s => `<option value="${s}">${s}</option>`).join('');
  
  filtroSemana.disabled = false;
 },
 
 configurarEventos() {
  filtroAno.addEventListener('change', () => {
   const mesesDoAno = [...new Set(this.dados.filter(d => d.ano === filtroAno.value).map(d => d.mes))].sort();
   filtroMes.innerHTML = '<option value="ALL">Todos os Meses</option>' +
    mesesDoAno.map(m => `<option value="${m}">${nomesMeses[m]}</option>`).join('');
   filtroMes.value = "ALL";
   filtroSemana.disabled = true;
   filtroSemana.innerHTML = '<option value="ALL">Todas</option>';
   this.atualizar();
  });
  
  filtroMes.addEventListener('change', () => {
   if (filtroMes.value === "ALL") {
    filtroSemana.disabled = true;
    filtroSemana.innerHTML = '<option value="ALL">Todas</option>';
   } else {
    filtroSemana.disabled = false;
    this.inicializarSemanas();
   }
   this.atualizar();
  });
  
  filtroSemana.addEventListener('change', () => this.atualizar());
  filtroAtivo.addEventListener('change', () => this.atualizar());
  
  toggleBtn.addEventListener('click', () => {
   this.modoPro = !this.modoPro;
   toggleBtn.classList.toggle('basic');
   document.getElementById('modeIcon').textContent = this.modoPro ? 'üî¨' : 'üìä';
   document.getElementById('modeText').textContent = this.modoPro ? 'MODO PRO' : 'MODO B√ÅSICO';
   this.atualizar();
  });
 },
 
 filtrar() {
  let dados = this.dados;
  
  if (filtroAno.value !== "ALL") {
   dados = dados.filter(d => d.ano === filtroAno.value);
  }
  
  if (filtroMes.value !== "ALL") {
   dados = dados.filter(d => d.mes === filtroMes.value);
  }
  
  if (filtroSemana.value !== "ALL") {
   dados = dados.filter(d => d.semana === filtroSemana.value);
  }
  
  if (filtroAtivo.value !== "ALL") {
   dados = dados.filter(d => d.ativo === filtroAtivo.value);
  }
  
  this.dadosFiltrados = dados;
 },
 
 atualizar() {
  this.filtrar();
  this.renderizarCards();
  this.renderizarGrafico();
  this.renderizarCalendario(this.dadosFiltrados);
  this.atualizarStatsSidebar();
 },
 
 voltarParaMeses() {
  filtroMes.value = "ALL";
  filtroSemana.disabled = true;
  filtroSemana.innerHTML = '<option value="ALL">Todas</option>';
  this.atualizar();
 },
 
 toggleCurrency() {
  currencyMode = currencyMode === 'USD' ? 'BRL' : 'USD';
  this.renderizarCards();
 },
 
 formatCurrency(value) {
  if (currencyMode === 'BRL') {
   const valueInBRL = value * exchangeRate;
   return `R$ ${valueInBRL.toFixed(2)}`;
  }
  return `$ ${value.toFixed(2)}`;
 },
 
 renderizarCards() {
  const d = this.dadosFiltrados;
  
  const totalTrades = d.reduce((acc, x) => acc + x.trades, 0);
  const totalPontos = d.reduce((acc, x) => acc + x.pontos, 0);
  const totalGains = d.reduce((acc, x) => acc + x.gain, 0);
  const totalStops = d.reduce((acc, x) => acc + x.stop, 0);
  const totalZeros = d.reduce((acc, x) => acc + x.zero, 0);
  const diasOperados = d.filter(x => x.trades > 0).length;
  const pontosMedia = diasOperados > 0 ? (totalPontos / diasOperados) : 0;
  const totalDolar = totalPontos * 2;
  
  const assertividade = totalTrades > 0 ? ((totalGains / totalTrades) * 100) : 0;
  
  if (this.modoPro) {
   cardsContainer.innerHTML = `
    <div class="card">
     <div class="card-header">
      <div class="card-title">Total de Pontos</div>
      <div class="card-icon">üìä</div>
     </div>
     <div class="card-value ${totalPontos > 0 ? 'positive' : totalPontos < 0 ? 'negative' : 'neutral'}">
      ${totalPontos > 0 ? '+' : ''}${totalPontos}
     </div>
     <div class="card-subtitle">${totalTrades} trades realizados</div>
     <div class="card-breakdown">
      <div class="breakdown-item">
       <div class="breakdown-label">Gain</div>
       <div class="breakdown-value gain">${totalGains}</div>
      </div>
      <div class="breakdown-item">
       <div class="breakdown-label">Stop</div>
       <div class="breakdown-value stop">${totalStops}</div>
      </div>
      <div class="breakdown-item">
       <div class="breakdown-label">0x0</div>
       <div class="breakdown-value zero">${totalZeros}</div>
      </div>
     </div>
    </div>
    
    <div class="card">
     <div class="card-header">
      <div class="card-title">Total em ${currencyMode === 'USD' ? 'D√≥lar' : 'Reais'}</div>
      <div class="card-icon">üíµ</div>
     </div>
     <div class="card-value-with-currency">
      <div class="card-value ${totalPontos > 0 ? 'positive' : totalPontos < 0 ? 'negative' : 'neutral'}">
       ${this.formatCurrency(totalDolar)}
      </div>
      <button class="currency-toggle ${currencyMode === 'BRL' ? 'active' : ''}" 
              onclick="Dashboard.toggleCurrency()" 
              title="Converter para ${currencyMode === 'USD' ? 'Reais' : 'D√≥lar'}">
       ${currencyMode === 'USD' ? 'üá∫üá∏' : 'üáßüá∑'}
      </button>
     </div>
     ${currencyMode === 'BRL' ? `<div class="currency-rate">Cota√ß√£o: R$ ${exchangeRate.toFixed(2)}</div>` : ''}
     <div class="card-subtitle">Cada ponto = ${currencyMode === 'USD' ? '$2.00' : 'R$ ' + (2 * exchangeRate).toFixed(2)}</div>
    </div>
    
    <div class="card">
     <div class="card-header">
      <div class="card-title">Assertividade</div>
      <div class="card-icon">üéØ</div>
     </div>
     <div class="card-value ${assertividade >= 50 ? 'positive' : 'negative'}">
      ${assertividade.toFixed(1)}%
     </div>
     <div class="card-subtitle">${totalGains} gains de ${totalTrades} trades</div>
    </div>
    
    <div class="card">
     <div class="card-header">
      <div class="card-title">M√©dia por Dia</div>
      <div class="card-icon">üìà</div>
     </div>
     <div class="card-value ${pontosMedia > 0 ? 'positive' : pontosMedia < 0 ? 'negative' : 'neutral'}">
      ${pontosMedia > 0 ? '+' : ''}${pontosMedia.toFixed(1)}
     </div>
     <div class="card-subtitle">${diasOperados} dias operados</div>
    </div>
   `;
   
   chartContainer.classList.remove('hide');
   
  } else {
   cardsContainer.innerHTML = `
    <div class="card">
     <div class="card-header">
      <div class="card-title">Total de Pontos</div>
      <div class="card-icon">üìä</div>
     </div>
     <div class="card-value ${totalPontos > 0 ? 'positive' : totalPontos < 0 ? 'negative' : 'neutral'}">
      ${totalPontos > 0 ? '+' : ''}${totalPontos}
     </div>
     <div class="card-subtitle">${totalTrades} trades ‚Ä¢ ${diasOperados} dias</div>
    </div>
    
    <div class="card">
     <div class="card-header">
      <div class="card-title">Total em ${currencyMode === 'USD' ? 'D√≥lar' : 'Reais'}</div>
      <div class="card-icon">üíµ</div>
     </div>
     <div class="card-value-with-currency">
      <div class="card-value ${totalPontos > 0 ? 'positive' : totalPontos < 0 ? 'negative' : 'neutral'}">
       ${this.formatCurrency(totalDolar)}
      </div>
      <button class="currency-toggle ${currencyMode === 'BRL' ? 'active' : ''}" 
              onclick="Dashboard.toggleCurrency()" 
              title="Converter para ${currencyMode === 'USD' ? 'Reais' : 'D√≥lar'}">
       ${currencyMode === 'USD' ? 'üá∫üá∏' : 'üáßüá∑'}
      </button>
     </div>
     ${currencyMode === 'BRL' ? `<div class="currency-rate">Cota√ß√£o: R$ ${exchangeRate.toFixed(2)}</div>` : ''}
    </div>
   `;
   
   chartContainer.classList.add('hide');
  }
 },
 
 atualizarStatsSidebar() {
  const d = this.dadosFiltrados;
  const statsSidebar = document.getElementById('statsSidebar');
  
  const totalGains = d.reduce((acc, x) => acc + x.gain, 0);
  const totalStops = d.reduce((acc, x) => acc + x.stop, 0);
  const totalZeros = d.reduce((acc, x) => acc + x.zero, 0);
  const diasOperados = d.filter(x => x.trades > 0).length;
  
  statsSidebar.innerHTML = `
   <div class="sidebar-stat">
    <span>Dias Operados</span>
    <span>${diasOperados}</span>
   </div>
   <div class="sidebar-stat">
    <span>Total Gains</span>
    <span style="color:var(--green)">${totalGains}</span>
   </div>
   <div class="sidebar-stat">
    <span>Total Stops</span>
    <span style="color:var(--red)">${totalStops}</span>
   </div>
   ${totalZeros > 0 ? `
    <div class="sidebar-stat">
     <span>Breakeven</span>
     <span style="color:var(--yellow)">${totalZeros}</span>
    </div>
   ` : ''}
  `;
 },
 
 renderizarGrafico() {
  const canvas = document.getElementById('chart');
  const ctx = canvas.getContext('2d');
  
  if (myChart) myChart.destroy();
  
  const d = this.dadosFiltrados.sort((a, b) => a.data - b.data);
  
  let acumulado = 0;
  const labels = d.map(x => x.dia);
  const valores = d.map(x => {
   acumulado += x.pontos;
   return acumulado;
  });
  
  myChart = new Chart(ctx, {
   type: 'line',
   data: {
    labels: labels,
    datasets: [{
     label: 'Pontos Acumulados',
     data: valores,
     borderColor: '#6366f1',
     backgroundColor: 'rgba(99,102,241,0.1)',
     borderWidth: 3,
     tension: 0.4,
     fill: true,
     pointRadius: 4,
     pointHoverRadius: 7,
     pointBackgroundColor: '#6366f1',
     pointBorderColor: '#fff',
     pointBorderWidth: 2
    }]
   },
   options: {
    responsive: true,
    maintainAspectRatio: true,
    plugins: {
     legend: { display: false },
     tooltip: {
      backgroundColor: 'rgba(15,20,32,0.95)',
      titleColor: '#f8fafc',
      bodyColor: '#cbd5e1',
      borderColor: '#6366f1',
      borderWidth: 1,
      padding: 12,
      displayColors: false,
      callbacks: {
       title: (items) => `üìÖ ${items[0].label}`,
       label: (item) => `üí∞ ${item.parsed.y > 0 ? '+' : ''}${item.parsed.y} pontos`
      }
     }
    },
    scales: {
     y: {
      beginAtZero: true,
      grid: { color: 'rgba(99,102,241,0.1)' },
      ticks: { color: '#cbd5e1', font: { weight: 600 } }
     },
     x: {
      grid: { display: false },
      ticks: { 
       color: '#cbd5e1', 
       font: { weight: 600 },
       maxRotation: 45,
       minRotation: 45
      }
     }
    }
   }
  });
 },
 
 abrirModal(dadosDia) {
  const modal = document.getElementById('tradePhotoModal');
  const modalTitle = document.getElementById('modalTitle');
  const modalInfoGrid = document.getElementById('modalInfoGrid');
  const modalPhotoContainer = document.getElementById('modalPhotoContainer');
  
  console.log('üìÇ Abrindo modal para:', dadosDia.dia);
  
  this.zoomLevel = 1;
  
  modalTitle.textContent = `Trade do dia ${dadosDia.dia}`;
  
  let infoHTML = `
   <div class="modal-info-item">
    <label>Semana</label>
    <div class="value">${dadosDia.semana}</div>
   </div>
   <div class="modal-info-item">
    <label>Ativo</label>
    <div class="value">${dadosDia.ativo}</div>
   </div>
   <div class="modal-info-item">
    <label>Trades</label>
    <div class="value">${dadosDia.trades}</div>
   </div>
   <div class="modal-info-item">
    <label>Pontos</label>
    <div class="value" style="color:${dadosDia.pontos<0?'var(--red)':dadosDia.pontos>0?'var(--green)':'var(--muted)'}">
     ${dadosDia.pontos > 0 ? '+' : ''}${dadosDia.pontos}
    </div>
   </div>
   <div class="modal-info-item">
    <label>Gains</label>
    <div class="value" style="color: var(--green)">${dadosDia.gain}</div>
   </div>
   <div class="modal-info-item">
    <label>Stops</label>
    <div class="value" style="color: var(--red)">${dadosDia.stop}</div>
   </div>
  `;
  
  if (dadosDia.zero > 0) {
   infoHTML += `
    <div class="modal-info-item">
     <label>Breakeven</label>
     <div class="value" style="color: var(--yellow)">${dadosDia.zero}</div>
    </div>
   `;
  }
  
  modalInfoGrid.innerHTML = infoHTML;
  
  console.log('üñºÔ∏è Carregando foto. ID:', dadosDia.fotoId);
  
  this.carregarFotoTrade(dadosDia.dia, modalPhotoContainer, dadosDia.fotoId);
  
  modal.classList.add('active');
  document.body.style.overflow = 'hidden';
  
  console.log('‚úÖ Modal aberto com sucesso');
 },
 
 fecharModal() {
  const modal = document.getElementById('tradePhotoModal');
  modal.classList.remove('active');
  document.body.style.overflow = 'auto';
  this.zoomLevel = 1;
 },
 
 zoomIn() {
  const img = document.querySelector('#modalPhotoContainer img');
  if (!img) return;
  
  this.zoomLevel += this.zoomStep;
  this.zoomLevel = Math.min(this.zoomLevel, 3); // Max 3x
  img.style.transform = `scale(${this.zoomLevel})`;
  img.style.cursor = this.zoomLevel > 1 ? 'zoom-out' : 'zoom-in';
 },
 
 zoomOut() {
  const img = document.querySelector('#modalPhotoContainer img');
  if (!img) return;
  
  this.zoomLevel -= this.zoomStep;
  this.zoomLevel = Math.max(this.zoomLevel, 1); // Min 1x
  img.style.transform = `scale(${this.zoomLevel})`;
  img.style.cursor = this.zoomLevel > 1 ? 'zoom-out' : 'zoom-in';
 },
 
 resetZoom() {
  const img = document.querySelector('#modalPhotoContainer img');
  if (!img) return;
  
  this.zoomLevel = 1;
  img.style.transform = 'scale(1)';
  img.style.cursor = 'zoom-in';
 },
 
 carregarFotoTrade(dataStr, container, fotoId) {
  const [dia, mes, ano] = dataStr.split('/');
  const nomeArquivo = `${dia}-${mes}-${ano}`;
  
  console.log('====== DEBUG FOTO ======');
  console.log('üìÖ Data:', dataStr);
  console.log('üìù Nome arquivo:', nomeArquivo);
  console.log('üÜî ID recebido:', fotoId);
  console.log('üîç ID tipo:', typeof fotoId);
  console.log('üìè ID length:', fotoId ? fotoId.length : 0);
  console.log('‚úÇÔ∏è ID trimmed:', fotoId ? fotoId.trim() : 'VAZIO');
  
  container.innerHTML = `
   <div class="modal-photo-loading">
    <div class="modal-photo-spinner"></div>
    Carregando foto...
   </div>
  `;
  
  if (fotoId && fotoId.trim()) {
   const idLimpo = fotoId.trim();
   
   const urls = [
    `https://drive.google.com/uc?export=view&id=${idLimpo}`,
    `https://drive.google.com/thumbnail?id=${idLimpo}&sz=w1000`,
    `https://lh3.googleusercontent.com/d/${idLimpo}`
   ];
   
   console.log('üì∏ Tentando URLs:');
   urls.forEach((u, i) => console.log(`   ${i+1}. ${u}`));
   
   let tentativaAtual = 0;
   
   const tentarProximaURL = () => {
    if (tentativaAtual >= urls.length) {
     console.error('‚ùå TODAS AS URLs falharam!');
     console.error('üî¥ ID usado:', idLimpo);
     console.error('');
     console.error('üîß CHECKLIST:');
     console.error('1. Foto est√° compartilhada como "Qualquer pessoa com o link"?');
     console.error('2. ID est√° correto?');
     console.error('3. Arquivo existe no Drive?');
     
     container.innerHTML = `
      <div class="modal-photo-error">
       ‚ùå N√£o foi poss√≠vel carregar a foto<br>
       <small style="font-size: 11px; opacity: 0.7; margin-top: 10px; display: block; line-height: 1.5;">
        <strong>ID testado:</strong><br>
        <code style="background: rgba(255,0,0,0.2); padding: 2px 6px; border-radius: 4px; font-size: 10px; word-break: break-all;">${idLimpo}</code><br><br>
        <strong>Verifique:</strong><br>
        1Ô∏è‚É£ Foto est√° como "Qualquer pessoa com o link"<br>
        2Ô∏è‚É£ ID est√° correto na planilha<br>
        3Ô∏è‚É£ Arquivo n√£o foi deletado<br><br>
        <strong>Teste voc√™ mesmo:</strong><br>
        Cole este link no navegador:<br>
        <code style="font-size: 9px; word-break: break-all;">drive.google.com/file/d/${idLimpo}/view</code>
       </small>
      </div>
     `;
     return;
    }
    
    const urlAtual = urls[tentativaAtual];
    console.log(`üîÑ Tentativa ${tentativaAtual + 1}/${urls.length}: ${urlAtual}`);
    
    const img = new Image();
    img.crossOrigin = 'anonymous';
    
    img.onload = () => {
     console.log(`‚úÖ SUCESSO na tentativa ${tentativaAtual + 1}!`);
     console.log('üñºÔ∏è URL que funcionou:', urlAtual);
     console.log('üìê Dimens√µes:', img.width, 'x', img.height);
     
     container.innerHTML = `<img src="${urlAtual}" alt="Trade do dia ${dataStr}" crossorigin="anonymous" onclick="Dashboard.toggleZoomClick()">`;
    };
    
    img.onerror = () => {
     console.warn(`‚ö†Ô∏è Falha na tentativa ${tentativaAtual + 1}`);
     tentativaAtual++;
     tentarProximaURL();
    };
    
    img.src = urlAtual;
   };
   
   tentarProximaURL();
   
  } else {
   console.warn('‚ö†Ô∏è NENHUM ID FORNECIDO');
   console.warn('Verifique se a coluna FOTO_ID tem valor na planilha');
   
   container.innerHTML = `
    <div class="modal-photo-error">
     üì∑ Nenhuma foto configurada<br>
     <small style="font-size: 11px; opacity: 0.8; margin-top: 10px; display: block;">
      O ID da foto n√£o est√° na planilha.<br><br>
      <strong>Como adicionar:</strong><br>
      1. Coluna <strong>FOTO_ID</strong> (coluna I)<br>
      2. Cole o ID da foto do Google Drive<br>
      3. Menu: <strong>üì∏ Fotos ‚Üí Sincronizar</strong>
     </small>
    </div>
   `;
  }
  
  console.log('========================');
 },
 
 toggleZoomClick() {
  const img = document.querySelector('#modalPhotoContainer img');
  if (!img) return;
  
  if (this.zoomLevel === 1) {
   this.zoomIn();
  } else {
   this.resetZoom();
  }
 },
 
 renderizarCalendario(dados) {
  const grid = document.getElementById("calendar");
  const calendarTitle = document.getElementById("calendarTitle");
  
  if (!grid) return;
  
  grid.innerHTML = "";
  
  if (filtroMes.value === "ALL") {
   if (calendarTitle) {
    calendarTitle.textContent = `üìÖ Selecione um M√™s`;
   }
   
   const mesesDisponiveis = [...new Set(
    this.dados
     .filter(d => d.ano === filtroAno.value)
     .map(d => d.mes)
   )].sort();
   
   mesesDisponiveis.forEach(mesNum => {
    const nomeMes = nomesMeses[mesNum];
    const dadosDoMes = this.dados.filter(d => d.ano === filtroAno.value && d.mes === mesNum);
    const totalPontos = dadosDoMes.reduce((acc, d) => acc + d.pontos, 0);
    const diasOperados = dadosDoMes.filter(d => d.trades > 0).length;
    
    const mesCard = document.createElement('div');
    mesCard.className = 'month-card';
    if (totalPontos > 0) mesCard.classList.add('positive');
    if (totalPontos < 0) mesCard.classList.add('negative');
    
    mesCard.innerHTML = `
     <div class="month-name">${nomeMes}</div>
     <div class="month-points" style="color:${totalPontos<0?'var(--red)':totalPontos>0?'var(--green)':'var(--muted)'}">
      ${totalPontos > 0 ? '+' : ''}${totalPontos}
     </div>
     <div class="month-info">${diasOperados} dia${diasOperados !== 1 ? 's' : ''}</div>
    `;
    
    mesCard.onclick = () => {
     filtroMes.value = mesNum;
     this.primeiraCarga = false;
     filtroSemana.disabled = false;
     this.inicializarSemanas();
     this.atualizar();
    };
    
    grid.appendChild(mesCard);
   });
   
   return;
  }
  
  if (!dados.length) return;
  
  let base = dados.find(d => d.mes === filtroMes.value) || dados[0];
  
  const ano = base.data.getFullYear();
  const mes = base.data.getMonth();
  const primeiro = new Date(ano, mes, 1);
  const ultimo = new Date(ano, mes+1, 0);
  
  const mesStr = (mes + 1).toString().padStart(2, "0");
  const nomeMes = nomesMeses[mesStr] || "";
  if (calendarTitle) {
   calendarTitle.innerHTML = `
    <button class="back-to-months-btn" onclick="Dashboard.voltarParaMeses()" title="Voltar para sele√ß√£o de meses">
     ‚Üê Voltar
    </button>
    <span>üìÖ ${nomeMes} ${ano}</span>
    <div></div>
   `;
  }
  
  for (let i = 0; i < primeiro.getDay(); i++) {
   const emptyDay = document.createElement('div');
   emptyDay.className = 'day empty';
   grid.appendChild(emptyDay);
  }
  
  for (let d = 1; d <= ultimo.getDate(); d++) {
   const data = new Date(ano, mes, d);
   const r = dados.find(x => x.data.toDateString() === data.toDateString());
   
   const dayDiv = document.createElement('div');
   dayDiv.className = 'day';
   
   let pts = "";
   let info = "";
   let badge = "";
   
   if (r) {
    pts = r.pontos;
    if (pts > 0) dayDiv.classList.add('positive');
    if (pts < 0) dayDiv.classList.add('negative');
    
    let primeiraLinha = `${r.trades} trade${r.trades !== 1 ? 's' : ''}`;
    
    let segundaLinha = [];
    if (r.gain > 0) segundaLinha.push(`${r.gain} gain${r.gain !== 1 ? 's' : ''}`);
    if (r.stop > 0) segundaLinha.push(`${r.stop} stop${r.stop !== 1 ? 's' : ''}`);
    if (r.zero > 0) segundaLinha.push(`${r.zero} 0x0`);
    
    if (segundaLinha.length > 0) {
     info = `${primeiraLinha}<br>${segundaLinha.join(' ‚Ä¢ ')}`;
    } else {
     info = primeiraLinha;
    }
    
    badge = `<div class="day-badge">${r.semana} ‚Ä¢ ${r.ativo}</div>`;
    
    if (r.trades > 0 && r.fotoId && r.fotoId.toString().trim() !== '') {
     dayDiv.classList.add('clickable');
     dayDiv.style.cursor = 'pointer';
     
     dayDiv.addEventListener('click', () => {
      Dashboard.abrirModal(r);
     });
    }
   }
   
   const ptsDisplay = r && r.trades > 0 ? (pts === 0 ? '0' : pts) : (pts || "");
   const ptsColor = pts < 0 ? 'var(--red)' : pts > 0 ? 'var(--green)' : 'var(--muted)';
   
   dayDiv.innerHTML = `
    <div class="day-number">${d}</div>
    <div class="day-points" style="color:${ptsColor}">
     ${ptsDisplay}
    </div>
    <div class="day-info">${info}</div>
    ${badge}
   `;
   
   grid.appendChild(dayDiv);
  }
 }
};

Dashboard.init();

document.getElementById('tradePhotoModal')?.addEventListener('click', (e) => {
 if (e.target.id === 'tradePhotoModal') {
  Dashboard.fecharModal();
 }
});

document.addEventListener('keydown', (e) => {
 if (e.key === 'Escape') {
  Dashboard.fecharModal();
 }
 if (e.ctrlKey && e.key === 'm') {
  e.preventDefault();
  document.getElementById('toggleMode')?.click();
 }
});
</script>
</body>
</html>
