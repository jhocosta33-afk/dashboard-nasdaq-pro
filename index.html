<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Mentoria NasdaqPro</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root{
 --bg:#020617;--card:#050b1a;--border:rgba(255,255,255,.08);
 --text:#e5e7eb;--muted:#9ca3af;
 --green:#22c55e;--red:#ef4444;--yellow:#facc15;--blue:#93c5fd;
}
*{box-sizing:border-box;font-family:Inter,system-ui}
body{
 margin:0;
 background:radial-gradient(circle at top,#0b1f4d,#020617 70%);
 color:var(--text);
}
.container{max-width:1600px;margin:auto;padding:28px}

.filters{display:flex;gap:14px;margin:20px 0;flex-wrap:wrap}
select{
 background:var(--card);border:1px solid var(--border);
 color:var(--text);border-radius:16px;padding:12px 16px;width:220px;
}

.kpis{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:16px;margin-bottom:28px}
.kpi{
 background:linear-gradient(180deg,#050b1a,#030818);
 border:1px solid var(--border);border-radius:20px;padding:18px
}
.kpi span{font-size:12px;color:var(--muted)}
.kpi strong{display:block;font-size:28px;margin-top:6px}

.cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(420px,1fr));gap:18px;margin-bottom:24px}
.card{
 background:linear-gradient(180deg,#050b1a,#030818);
 border:1px solid var(--border);border-radius:26px;padding:18px;
 height:420px;display:flex;flex-direction:column
}
.card strong{margin-bottom:10px}
.chart-wrap{flex:1;position:relative}
canvas{width:100%!important;height:100%!important}

table{width:100%;border-collapse:collapse;min-width:900px}
th,td{padding:14px;border-bottom:1px solid var(--border);text-align:center}
th{color:var(--blue)}
td:first-child,th:first-child{text-align:left}
tr.total{background:rgba(34,197,94,.08);font-weight:700}
</style>
</head>

<body>
<div class="container">

<h1>Mentoria NasdaqPro</h1>
<span>DASHBOARD</span>

<div class="filters">
 <select id="fAno"></select>
 <select id="fMes"></select>
 <select id="fSemana"></select>
</div>

<div class="kpis">
 <div class="kpi"><span>TRADES</span><strong id="kTrades">0</strong></div>
 <div class="kpi"><span>PONTOS</span><strong id="kPontos">0</strong></div>
 <div class="kpi"><span>GAINS</span><strong id="kGains" style="color:var(--green)">0</strong></div>
 <div class="kpi"><span>STOPS</span><strong id="kStops" style="color:var(--red)">0</strong></div>
 <div class="kpi"><span>0x0</span><strong id="kZero" style="color:var(--yellow)">0</strong></div>
 <div class="kpi"><span>ASSERTIVIDADE</span><strong id="kAcc">0%</strong></div>
</div>

<div class="cards">
 <div class="card">
  <strong>ðŸ“ˆ BalanÃ§o de Pontos</strong>
  <div class="chart-wrap"><canvas id="chartLinha"></canvas></div>
 </div>

 <div class="card">
  <strong>ðŸ“Š Gains x Stops x 0x0</strong>
  <div class="chart-wrap"><canvas id="chartBar"></canvas></div>
 </div>
</div>

<div class="card" style="height:auto">
 <strong>Tabela Operacional</strong>
 <div style="overflow-x:auto">
 <table>
  <thead>
   <tr>
    <th>Dia</th><th>Pontos</th><th>Trades</th>
    <th>Gain</th><th>Stop</th><th>0x0</th>
    <th>Ativo</th><th>Semana</th>
   </tr>
  </thead>
  <tbody id="tbody"></tbody>
 </table>
 </div>
</div>

</div>

<script>
const CSV="https://docs.google.com/spreadsheets/d/e/2PACX-1vTbyybCny81vfVXQHmtlkKEOHHJ6xJ_pKSG_4ndkK0tH-YocrFeWY7qL41TS1IfvRQjLSbLIILV56OV/pub?output=csv";

let dados=[],chartLinha,chartBar;

fetch(CSV).then(r=>r.text()).then(t=>{
 const rows=t.trim().split(/\r?\n/);rows.shift();
 dados=rows.map(r=>{
  const c=r.split(",");
  return{
   dia:c[0],semana:c[1],ativo:c[2],
   pontos:+c[3],trades:+c[4],
   gain:+c[5],stop:+c[6],zero:+c[7],
   ano:c[0].slice(6),mes:c[0].slice(3,5)
  }
 });
 initFiltros();
});

function initFiltros(){
 const anos=[...new Set(dados.map(d=>d.ano))];
 fAno.innerHTML=anos.map(a=>`<option>${a}</option>`).join("");
 fAno.onchange=()=>initMes();
 initMes();
}

function initMes(){
 const meses=[...new Set(dados.filter(d=>d.ano===fAno.value).map(d=>d.mes))];
 fMes.innerHTML='<option value="ALL">Todos os meses</option>'+
 meses.map(m=>`<option value="${m}">${m}</option>`).join("");
 fMes.onchange=()=>initSemana();
 initSemana();
}

function initSemana(){
 if(fMes.value==="ALL"){
  fSemana.innerHTML='<option value="ALL">Todas as semanas</option>';
  fSemana.disabled=true;
 }else{
  fSemana.disabled=false;
  const semanas=[...new Set(dados.filter(d=>d.ano===fAno.value && d.mes===fMes.value).map(d=>d.semana))];
  fSemana.innerHTML='<option value="ALL">Todas as semanas</option>'+
   semanas.map(s=>`<option>${s}</option>`).join("");
 }
 fSemana.onchange=update;
 update();
}

function update(){
 const f=dados.filter(d=>
  d.ano===fAno.value &&
  (fMes.value==="ALL"||d.mes===fMes.value) &&
  (fSemana.value==="ALL"||d.semana===fSemana.value)
 );
 renderKPIs(f);renderTabela(f);renderGraficos(f);
}

function renderKPIs(f){
 let t={p:0,tr:0,g:0,s:0,z:0};
 f.forEach(d=>{t.p+=d.pontos;t.tr+=d.trades;t.g+=d.gain;t.s+=d.stop;t.z+=d.zero});
 kTrades.textContent=t.tr;
 kPontos.textContent=t.p;
 kGains.textContent=t.g;
 kStops.textContent=t.s;
 kZero.textContent=t.z;
 kAcc.textContent=(t.g+t.s)?Math.round(t.g/(t.g+t.s)*100)+"%":"0%";
}

function renderTabela(f){
 tbody.innerHTML="";
 let tot={p:0,tr:0,g:0,s:0,z:0};
 f.forEach(d=>{
  tot.p+=d.pontos;tot.tr+=d.trades;
  tot.g+=d.gain;tot.s+=d.stop;tot.z+=d.zero;
  tbody.innerHTML+=`
  <tr>
   <td>${d.dia}</td>
   <td style="color:${d.pontos<0?'var(--red)':'var(--green)'}">${d.pontos}</td>
   <td>${d.trades}</td>
   <td>${d.gain}</td>
   <td>${d.stop}</td>
   <td>${d.zero}</td>
   <td>${d.ativo}</td>
   <td>${d.semana}</td>
  </tr>`;
 });
 tbody.innerHTML+=`
 <tr class="total">
  <td>TOTAL</td>
  <td>${tot.p}</td><td>${tot.tr}</td>
  <td>${tot.g}</td><td>${tot.s}</td><td>${tot.z}</td>
  <td colspan="2"></td>
 </tr>`;
}

function renderGraficos(f){
 let acc=0,labels=[],saldo=[],pontosDia=[];
 f.forEach(d=>{
  acc+=d.pontos;
  labels.push(d.dia);
  saldo.push(acc);
  pontosDia.push(d.pontos);
 });

 if(chartLinha)chartLinha.destroy();
 chartLinha=new Chart(chartLinhaEl,{
  type:"line",
  data:{labels,datasets:[{
   data:saldo,
   borderColor:"#22c55e",
   fill:true,
   backgroundColor:"rgba(34,197,94,.25)",
   tension:.35
  }]},
  options:{
   responsive:true,
   interaction:{mode:"index",intersect:false},
   plugins:{
    legend:{display:false},
    tooltip:{
     callbacks:{
      label:(ctx)=>`Saldo: ${ctx.parsed.y}`
     }
    }
   },
   scales:{x:{ticks:{color:"#9ca3af"}},y:{ticks:{color:"#9ca3af"}}}
  }
 });

 if(chartBar)chartBar.destroy();
 chartBar=new Chart(chartBarEl,{
  type:"bar",
  data:{
   labels:["Gain","Stop","0x0"],
   datasets:[{
    data:[
     f.reduce((a,b)=>a+b.gain,0),
     f.reduce((a,b)=>a+b.stop,0),
     f.reduce((a,b)=>a+b.zero,0)
    ],
    backgroundColor:["#22c55e","#ef4444","#facc15"],
    borderRadius:12
   }]
  },
  options:{plugins:{legend:{display:false}},responsive:true}
 });
}

const chartLinhaEl=document.getElementById("chartLinha");
const chartBarEl=document.getElementById("chartBar");
</script>

</body>
</html>
