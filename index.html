<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<title>Dashboard NASDAQ PRO</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root{
  --bg:#050b1a;
  --card:#0b1228;
  --border:rgba(255,255,255,.08);
  --text:#e5e7eb;
  --muted:#9ca3af;
  --green:#22c55e;
  --red:#ef4444;
  --yellow:#facc15;
  --blue:#3b82f6;
}

*{box-sizing:border-box;font-family:Inter,Arial,sans-serif}

body{
  margin:0;
  background:radial-gradient(circle at top,#0b1228,#020617 70%);
  color:var(--text);
}

.container{
  max-width:1400px;
  margin:auto;
  padding:24px;
}

h1{margin:0 0 16px}

.filters{
  display:flex;
  gap:12px;
  margin-bottom:20px;
}

select{
  background:var(--card);
  color:var(--text);
  border:1px solid var(--border);
  padding:10px 14px;
  border-radius:10px;
  cursor:pointer;
}

.kpis{
  display:grid;
  grid-template-columns:repeat(6,1fr);
  gap:16px;
  margin-bottom:24px;
}

.kpi{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:16px;
  padding:16px;
}

.kpi span{
  font-size:13px;
  color:var(--muted);
}

.kpi strong{
  display:block;
  font-size:26px;
  margin-top:6px;
}

.cards{
  display:grid;
  grid-template-columns:2fr 1fr;
  gap:16px;
  margin-bottom:24px;
}

.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:18px;
  padding:16px;
  min-height:320px;
}

table{
  width:100%;
  border-collapse:collapse;
}

th,td{
  padding:10px;
  border-bottom:1px solid var(--border);
  text-align:center;
  font-size:14px;
}

th{color:#93c5fd}
</style>
</head>

<body>
<div class="container">

<h1>Dashboard NASDAQ PRO</h1>

<div class="filters">
  <select id="filtroMes" onchange="trocarMes()"></select>
  <select id="filtroSemana" onchange="atualizarDashboard()"></select>
</div>

<div class="kpis">
  <div class="kpi"><span>Trades</span><strong id="kTrades">0</strong></div>
  <div class="kpi"><span>Pontos</span><strong id="kPontos" style="color:var(--blue)">0</strong></div>
  <div class="kpi"><span>Gains</span><strong id="kGains" style="color:var(--green)">0</strong></div>
  <div class="kpi"><span>Stops</span><strong id="kStops" style="color:var(--red)">0</strong></div>
  <div class="kpi"><span>0x0</span><strong id="kZero" style="color:var(--yellow)">0</strong></div>
  <div class="kpi"><span>Assertividade</span><strong id="kAssert">0%</strong></div>
</div>

<div class="cards">
  <div class="card"><canvas id="graficoLinha"></canvas></div>
  <div class="card"><canvas id="graficoBarra"></canvas></div>
</div>

<div class="card">
<table>
<thead>
<tr>
  <th>Dia</th><th>Semana</th><th>Pontos</th>
  <th>Trades</th><th>Gain</th><th>Stop</th><th>0x0</th>
</tr>
</thead>
<tbody id="tabela"></tbody>
</table>
</div>

</div>

<script>
// ======= DADOS (CSV já tratado) =======
const dados = [
 {dia:'01/12/2025',mes:'Dezembro',semana:'SEMANA 1',pontos:40,trades:2,gain:1,stop:0,zero:1},
 {dia:'02/12/2025',mes:'Dezembro',semana:'SEMANA 1',pontos:98,trades:2,gain:2,stop:0,zero:0},
 {dia:'03/12/2025',mes:'Dezembro',semana:'SEMANA 1',pontos:26,trades:2,gain:1,stop:1,zero:0},
 {dia:'04/12/2025',mes:'Dezembro',semana:'SEMANA 1',pontos:-25,trades:3,gain:1,stop:2,zero:0},
 {dia:'05/12/2025',mes:'Dezembro',semana:'SEMANA 1',pontos:89,trades:2,gain:2,stop:0,zero:0},
 {dia:'08/12/2025',mes:'Dezembro',semana:'SEMANA 2',pontos:45,trades:2,gain:1,stop:1,zero:0},
];

// ======= FILTROS =======
const filtroMes = document.getElementById('filtroMes');
const filtroSemana = document.getElementById('filtroSemana');

// ======= GRÁFICOS =======
let chartLinha, chartBarra;

// ======= INIT =======
initFiltros();
atualizarDashboard();

function initFiltros(){
  const meses = [...new Set(dados.map(d=>d.mes))];

  filtroMes.innerHTML = `<option value="TODOS">TODOS OS MESES</option>`;
  meses.forEach(m=>filtroMes.innerHTML+=`<option value="${m}">${m}</option>`);

  atualizarFiltroSemanas('TODOS');
}

// ======= SEMANAS POR MÊS =======
function atualizarFiltroSemanas(mes){
  filtroSemana.innerHTML = `<option value="TODAS">TODAS AS SEMANAS</option>`;

  if(mes === 'TODOS'){
    filtroSemana.disabled = true;
    return;
  }

  filtroSemana.disabled = false;

  const semanas = [...new Set(
    dados.filter(d=>d.mes===mes).map(d=>d.semana)
  )];

  semanas.forEach(s=>{
    filtroSemana.innerHTML += `<option value="${s}">${s}</option>`;
  });
}

// ======= TROCAR MÊS =======
function trocarMes(){
  atualizarFiltroSemanas(filtroMes.value);
  atualizarDashboard();
}

// ======= DASHBOARD =======
function atualizarDashboard(){
  let filtrado = [...dados];

  if(filtroMes.value !== 'TODOS')
    filtrado = filtrado.filter(d=>d.mes===filtroMes.value);

  if(!filtroSemana.disabled && filtroSemana.value !== 'TODAS')
    filtrado = filtrado.filter(d=>d.semana===filtroSemana.value);

  renderKPIs(filtrado);
  renderTabela(filtrado);
  renderGraficos(filtrado);
}

// ======= KPIs =======
function renderKPIs(d){
  const sum = (k)=>d.reduce((a,b)=>a+(b[k]||0),0);

  document.getElementById('kTrades').textContent = sum('trades');
  document.getElementById('kPontos').textContent = sum('pontos');
  document.getElementById('kGains').textContent = sum('gain');
  document.getElementById('kStops').textContent = sum('stop');
  document.getElementById('kZero').textContent = sum('zero');

  const total = sum('gain') + sum('stop');
  document.getElementById('kAssert').textContent =
    total ? ((sum('gain')/total)*100).toFixed(1)+'%' : '0%';
}

// ======= TABELA =======
function renderTabela(d){
  const tb = document.getElementById('tabela');
  tb.innerHTML = '';
  d.forEach(r=>{
    tb.innerHTML += `
    <tr>
      <td>${r.dia}</td><td>${r.semana}</td><td>${r.pontos}</td>
      <td>${r.trades}</td><td>${r.gain}</td>
      <td>${r.stop}</td><td>${r.zero}</td>
    </tr>`;
  });
}

// ======= GRÁFICOS =======
function renderGraficos(d){
  const labels = d.map(x=>x.dia);
  const pontos = d.map(x=>x.pontos);

  if(chartLinha) chartLinha.destroy();
  if(chartBarra) chartBarra.destroy();

  chartLinha = new Chart(graficoLinha,{
    type:'line',
    data:{
      labels,
      datasets:[{
        data:pontos,
        borderColor:'#22c55e',
        backgroundColor:'rgba(34,197,94,.25)',
        fill:true,
        tension:.35
      }]
    },
    options:{
      plugins:{legend:{display:false}},
      scales:{x:{ticks:{color:'#9ca3af'}},y:{ticks:{color:'#9ca3af'}}}
    }
  });

  chartBarra = new Chart(graficoBarra,{
    type:'bar',
    data:{
      labels:['Gains','Stops','0x0'],
      datasets:[{
        data:[
          d.reduce((a,b)=>a+b.gain,0),
          d.reduce((a,b)=>a+b.stop,0),
          d.reduce((a,b)=>a+b.zero,0)
        ],
        backgroundColor:['#22c55e','#ef4444','#facc15']
      }]
    },
    options:{plugins:{legend:{display:false}}}
  });
}
</script>
</body>
</html>
